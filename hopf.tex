%%!TEX root = the-hopf.tex
\chapter{Boundary}\label{chap:bry}

This lecture defines the boundary of a finite-dimensional Alexandrov space.
After discussing its properties, we prove the doubling theorem (\ref{thm:doubling:doubling}).

\section{Definition}

Let us give an inductive definition of the boundary of finite-dimensional Alexandrov spaces.

Suppose $\spc{A}$ is a 1-dimensional Alexandrov space.
By Exercise~\ref{ex:dim=1},
$\spc{A}$ is homeomorphic to a 1-dimensional manifold (possibly with non-empty boundary).
This  allows us to define the boundary $\partial\spc{A}\subset \spc{A}$ as the boundary of the manifold.

Now assume that the notion of boundary is defined in dimensions $1,\dots,m-1$.
Suppose  $\spc{A}$ is $m$-dimensional Alexandrov space.
We say that $p\in \spc{A}$ belongs to the boundary (briefly $p\in \partial \spc{A}$) if 
$\partial\Sigma_p\ne\emptyset$.
By \ref{thm:finite-space-of-directions} and \ref{ex:finite-space-of-directions-dim}, $\Sigma_p$ is an $(m-1)$-dimensional Alexandrov space;
therefore its boundary is already defined and hence this inductive definition makes sense.

It is instructive to check the following statements.
\begin{itemize}
\item For a closed convex set $K\subset \EE^m$ with non-empty interior, the topological boundary of $K$ as a subset of $\EE^m$ coincides with the boundary $K$ described above.
\item If $\spc{A}\iso\spc{A}_1\times\spc{A}_2$ is a finite-dimensional Alexandrov space,
then
\[\partial \spc{A}=(\partial\spc{A}_1\times\spc{A}_2)\,\cup\,(\spc{A}_1\times\partial\spc{A}_2)\]
\item If $\Cone\Sigma$ is an $\Alex0$ space of dimensions $\ge 2$  (this necessarily implies that   $\Cone\Sigma$  is  $\Alex1 $ then
\[\partial \Cone\Sigma=\Cone\partial\Sigma,\]
where $\Cone\partial\Sigma=\set{s\cdot \xi\in\Cone\Sigma }{\xi\in \partial\Sigma}$.
\end{itemize}


\section{Conic neighborhoods}

The following statement \cite{perelman1993} is a close relative of Perelman's stability theorem \ref{thm:stability}.
% but its proof is  simpler .
We are going to use this result without proof.

Recall that the logarithm $\log_px\:\spc{A}\to \T_p$ is defined on page \pageref{page:log}.

\begin{thm}{Theorem}\label{thm:spherical-nbhd}
For any point $p$ in a finite-dimensional Alexandrov space $\spc{A}$
and all sufficiently small $\eps>0$
there is a homeomorphism $h_\eps\:\oBall(p,\eps)_{\spc{A}}\to \oBall(0,\eps)_{\T_p}$ such that $0=h_\eps(p)$.

Moreover, we may assume that 
\[
\sup_{x\in \oBall(p,\eps)}\{\,\tfrac1\eps\cdot\dist{\log_px}{h_\eps(x)}{\T_p}\,\}\to 0
\quad\text{as}\quad
\eps\to 0.\]
\end{thm}

This statement is often used together with the \textit{uniqueness of conic neighborhoods} stated below.

Suppose that an open  neighborhood $U$ of a point $x$ in a metric space $\spc{X}$
% openness is very important. it's false otherwise
admits a homeomorphism to $\Cone\Sigma$ such that $x$ is mapped to the origin of the cone.
In this case, we say that $U$ has a \index{conic neighborhood}\emph{conic neighborhood} of~$x$.

\begin{thm}{Uniqueness of conic neighborhoods}\label{lem:kwun}
Any two conic neighborhoods of a given point in a metric space are \index{pointed homeomorphic}\emph{pointed homeomorphic}; that is, there is a homeomorphism between neighborhoods that maps the origin of one cone to the origin of the other.
\end{thm}

\begin{thm}{Advanced exercise}\label{ex:conic}
Prove \ref{lem:kwun} or read the proof in \cite{kwun1964}.
\end{thm}


\begin{thm}{Exercise}\label{ex:conic-tangent}
Suppose $x\mapsto x'$ is a homeomorphism between finite-dimensional Alexandrov spaces $\spc{A}$ and $\spc{A}'$. Show that 

\begin{subthm}{ex:conic-tangen:tangent}
$\T_x\cong \T_{x'}$,
\end{subthm}

\begin{subthm}{ex:conic-tangen:dir}
$\Susp\Sigma_x\cong \Susp\Sigma_{x'}$.
\end{subthm}

\begin{subthm}{ex:conic-tangen:example}
but in general $\Sigma_x\ncong\Sigma_{x'}$.
\end{subthm}

\end{thm}



\section{Topology}

The following theorem states that boundary is an object of topology, despite our definition have used geometry.

\begin{thm}{Theorem}\label{thm:top-bry}
Let $\spc{A}$ and $\spc{A}'$ be homeomorphic finite-dimensional Alexandrov spaces.
Then $\dim \spc{A}=\dim\spc{A}'$ and
\[\partial\spc{A}\ne \emptyset
\quad\iff\quad
\partial\spc{A}'\ne \emptyset
\]
\end{thm}

While working on the proof, keep in mind that there are pairs of spaces $\spc{K}_1$ and $\spc{K}_2$ such that $\spc{K}_1\ncong \spc{K}_2$, but $\RR\times \spc{K}_1\cong \RR\times \spc{K}_2$.
Suspension over the Poincar√© homology sphere with $\SSS^4$ is one of the examples; compare to \ref{ex:conic-tangen:example}.

Let $\spc{A}$ be an $m$-dimensional Alexandrov space and $m<\infty$.
Define \index{rank}\emph{rank} of $\spc{A}$ (briefly, \index{$\rank\spc{A}$}$\rank\spc{A}$) as the minimal value $k$ such that $\spc{A}$ splits isometrically as $\RR^{m-k}\times \spc{K}$;
note that here $\spc{K}$ is a $k$-dimensional Alexandrov space.

In the following proof we will apply induction on the rank of $\spc{A}$.


\parit{Proof.}
The first statement follows from \ref{thm:dim=dim}.

Suppose we have a counterexample, say $\partial \spc{A}\ne \emptyset$, but $\partial \spc{A}'=\emptyset$.
Let $k\df\rank \spc{A}$ and $k'\df\rank \spc{A}'$.
We can assume that the pair $(k,k')$ is minimal in lexicographic order;
in particular, $k$ is minimal.
Let $x\mapsto x'$ be a homeomorphism from $\spc{A}$ to $\spc{A}'$.

Choose $x\in \partial \spc{A}$.
Since $\partial \spc{A}'=\emptyset$, we have $x'\notin \partial \spc{A}'$.
Note that 
\[\rank \T_x\le k
\quad\text{and}\quad
\rank \T_{x'}\le k',
\]
By \ref{ex:conic-tangen:tangent}, $\T_x\cong\T_{x'}$.
Note that $\partial \T_x\ne\emptyset$ and $\partial \T_{x'}=\emptyset$.
Therefore, we may assume that $\spc{A}$ and $\spc{A}'$ are Euclidean cones
and the homeomorphism sends the origin to the origin.
The remaining part of the proof is divided into three cases.

\parit{Case 1.}
Suppose $k>1$.
Let $\spc{A}\iso \RR^{m-k}\times \spc{C}$, where $\spc{C}$ a $k$-dimensional $\Alex0$ cone.
Observe that $\rank\T_y\le\rank\spc{A}$ for any $y\in\spc{A}$ and the equality holds only if $y$ projects to the origin of $\spc{C}$.

Since $k>1$ we can find $z\in\partial\spc{C}$ such that $z\ne 0$.
Choose $y$ that projects to $z$;
in particular, $\rank\T_y<\rank\spc{A}$.
By \ref{ex:conic-tangen:tangent}, $\T_y\cong\T_{y'}$,
$\partial  \T_y\ne\emptyset$ and $\partial \T_{y'}=\emptyset$.
The latter contradicts the minimality of $k$.

\parit{Case 2.} Suppose $k\le1$ and $k'>1$.
Since $\partial \spc{A}\ne \emptyset$, we get that $k=1$;
therefore, $\spc{A}=\RR^{m-1}\times\RR_{\ge0}$.

Let $\spc{A}'\iso \RR^{m-k'}\times \spc{C}'$, where $\spc{C}'$ a $k'$-dimensional $\Alex0$ cone.
Since $\partial\spc{A}\cong\RR^{m-1}$,
the image of $\partial\spc{A}$ in $\spc{A}'$ does not lie in $\RR^{m-k'}\z\times\{0\}$.
In other words, we can choose $y\in \partial \spc{A}$ such that its image $y'\in \spc{A}'$ has a nonzero projection in $\spc{C}'$.
Observe that $\T_y\cong\T_{y'}$,
\[
\rank\T_y\le k=1,
\quad
\rank\T_{y'}< k',
\quad
\partial \T_y=\emptyset,
\quad\text{and}\quad
\partial \T_{y'}\ne \emptyset\]
--- a contradiction.

\parit{Case 3.}
Suppose $k\le 1$ and $k'\le 1$.
Since $\partial \spc{A}\ne \emptyset$, $k=1$.
By \ref{ex:dim=1}, $\spc{A}\z\cong \RR^{m-1}\times\RR_{\ge0}$.
Therefore, $\spc{A}'\cong\RR^m$, and $\spc{A}\ncong\spc{A}'$ --- a contradiction.
\qeds

\begin{thm}{Exercise}\label{ex:bry2bry}
Let $x\mapsto x'$ be a homeomorphism $\Omega\to\Omega'$
between open subsets in finite-dimensional Alexandrov spaces $\spc{A}$ and $\spc{A}'$.
Show that $x\in \partial \spc{A}$ if and only if $x'\in \partial \spc{A}'$.

\end{thm}

\begin{thm}{Exercise}\label{ex:bry-closed}
Show that boundary of a finite-dimensional Alexandrov space is a closed subset.
\end{thm}

\section{Tangent space}

Let $X$ be a subset in a finite-dimensional Alexandrov space $\spc{A}$.
Choose $p\in \spc{A}$ and $\xi\in \Sigma_p$.
Suppose $\xi$ is a limit of directions $\dir{p}{x_n}$ for a sequence $x_1,x_2,\dots{}\in X$ that converges to $p$.
Then we say that $\xi$ is in the \index{space of directions}\emph{space of directions} from $p$ to $X$;
briefly \index{$\Sigma_p$ (space of directions)}$\xi\in\Sigma_pX$.

Further, $\Cone(\Sigma_pX)$ will be called \index{tangent space}\emph{tangent space} to $X$ at $p$;
it will be denoted by \index{$\T_p$ (tangent space)}$\T_pX$.
%\footnote{{\red V: tangent spaces have already been defined in chapter 4. also, I think we should state somewhere (in chapter 7?) the theorem the pointed rescaled  finite-dimensional Alexandrov space converges to the tangent space.} A: see \ref{ex:GHto-tangent} + now it is tangent space to a subset...}

\begin{thm}{Theorem}\label{thm:partial-Sigma}
For any finite-dimensional Alexandrov space $\spc{A}$, we have
\[\partial (\Sigma_p\spc{A})=\Sigma_p(\partial\spc{A})
\quad\text{and}\quad
\partial(\T_p\spc{A})=\T_p(\partial\spc{A}).\]
\end{thm}

\parit{Proof.}
Choose a sequence $x_n\in \partial \spc{A}$ such that $x_n\to p$ and $\dir p{x_n}\to\xi$.

Let $\eps_n=2\cdot \dist{p}{x_n}{}$,
and let $h_{\eps_n}\:\oBall(p,\eps_n)_{\spc{A}}\to \oBall(0,\eps_n)_{\T_p}$ be the homeomorphisms provided by \ref{thm:spherical-nbhd};
in particular, $\tfrac2{\eps_n}\cdot h_{\eps_n}(x_n)\to \xi$ as $n\to\infty$.
By \ref{ex:bry2bry}, $h_{\eps_n}(x_n)\in \partial \T_p$.
By \ref{ex:bry-closed}, $\xi\in \partial \T_p$.
Therefore,
\[\partial (\Sigma_p\spc{A})\supset\Sigma_p(\partial\spc{A})
\quad\text{and}\quad
\partial(\T_p\spc{A})\supset\T_p(\partial\spc{A}).\]

Similarly, choose $\xi\in\partial\Sigma_p$.
Let $h_{\eps_n}\:\oBall(p,\eps_n)_{\spc{A}}\to \oBall(0,\eps_n)_{\T_p}$ be the homeomorphisms provided by \ref{thm:spherical-nbhd} for a sequence $\eps_n\to 0$ as $n\to\infty$.
By \ref{ex:bry2bry}, $x_n=h_{\eps_n}^{-1}(\tfrac{\eps_n}2\cdot\xi)\in \partial \spc{A}$.
By \ref{thm:spherical-nbhd}, $\dir p{x_n}\to \xi$.
Hence
\[\partial (\Sigma_p\spc{A})\subset\Sigma_p(\partial\spc{A})
\quad\text{and}\quad\partial(\T_p\spc{A})\subset\T_p(\partial\spc{A}).\]
\qedsf

\section{Doubling}

Let $A$ be a closed subset in a metric space $\spc{X}$.
The \index{doubling}\emph{doubling} $\spc{W}$ of $\spc{X}$ across $A$ is two copies of $\spc{X}$ glued along $A$;
more precisely, the underlying set of $\spc{W}$ is the quotient $\spc{X}\times\{0,1\}/\sim$, where $(a,0)\sim (a,1)$ for any $a\in A$ and $\spc{W}$ is equipped with the minimal metric such that both maps $\spc{X}\to \spc{W}$ defined by $x\mapsto (x,0)$ and $x\mapsto (x,1)$ are distance-preserving.

Alternatively, one may say that $\spc{W}$ is equipped with the maximal metric such that the projection $\proj\:\spc{W}\to\spc{A}$ defined by $(x,i)\mapsto x$ is a short map. 
The metric on $\spc{W}$ can also be defined explicitly as
\[\dist{(x,i)}{(y,j)}{\spc{W}}=
\begin{cases}
\dist{x}{y}{\spc{X}}&\text{if}\quad i= j.
\\
\inf\set{\dist{x}{a}{\spc{X}}+\dist{y}{a}{\spc{X}}}{a\in A}&\text{if}\quad i\ne j.
\end{cases}
\]

\begin{thm}{Theorem}\label{thm:doubling}
Let $\spc{A}$ be a finite-dimensional Alexandrov space with non-empty boundary.
Suppose $f\z=\tfrac12\cdot\distfun_p^2$ for some $p\in \spc{A}$.
Then

\begin{subthm}{thm:doubling:concave}
If $\dim \spc{A}\ge 2$, then
$\distfun_{\partial \Sigma_x}(\xi)\le \tfrac\pi2$ for any $x\in\partial \spc{A}$ and $\xi\in \Sigma_x$.
Moreover, if $\distfun_{\partial \Sigma_x}(\xi)= \tfrac\pi2$, then $\mangle(\xi,\zeta)\le\tfrac\pi2$ for any $\zeta\in \Sigma_x$. 
\end{subthm}

\begin{subthm}{thm:partial-grad:grad}
$\nabla_xf\in \partial\T_x$ for any $x\in\partial \spc{A}$.
\end{subthm}

\begin{subthm}{thm:partial-grad:flow}
If $\alpha$ is an $f$-gradient curve that starts at $x\in \partial \spc{A}$, then $\alpha(t)\in \partial \spc{A}$ for any $t$.
Moreover, if $p\in \partial \spc{A}$, then $\gexp_p(v)\in \partial \spc{A}$ for any $v\in\partial\T_p$.
\end{subthm}

\begin{subthm}{thm:doubling:doubling}
The doubling $\spc{W}$ of $\spc{A}$ across $\partial \spc{A}$ is an Alexandrov space with the same curvature bound.
\end{subthm}

\end{thm}

Part \ref{SHORT.thm:doubling:doubling} is called the \index{doubling theorem}\emph{doubling theorem}.

\parit{Proof.}
We will denote by 
\ref{SHORT.thm:doubling:concave}$_m,\dots,$\ref{SHORT.thm:doubling:doubling}$_m$ the corresponding statement assuming $m=\dim\spc{A}$.

The proof goes by induction on $m$.
Note that \ref{SHORT.thm:doubling:doubling}$_1$ follows from \ref{ex:dim=1} --- this is the base.
The step is a combination of the implications below.

\parit{\ref{SHORT.thm:doubling:doubling}$_{m-1}\Rightarrow$\ref{SHORT.thm:doubling:concave}$_m$.}
Suppose $m=2$, then $\dim\Sigma_x=1$; see \ref{ex:finite-space-of-directions-dim}.
By \ref{ex:dim=1}, $\Sigma_x$ isometric to a line segment $[0,\ell]$;
we need to show that $\ell\le\pi$.

Assume $\ell>\pi$, then the tangent space $\T_x=\Cone\Sigma_x$ has several different lines thru the origin.
Recall that $\T_x$ is an Alexandrov space; see \ref{ex:finite-tan}.
By \ref{cor:splitting}, $\T_x$ is isometric to the Euclidean plane;
the latter contradicts that $\Sigma_x$ is a line segment.

Now suppose $m>2$, so $\dim \Sigma_x>1$.
Assume $\distfun_{\partial \Sigma_x}(\xi)> \tfrac\pi2$ for some $\xi$.
By \ref{SHORT.thm:doubling:doubling}$_{m-1}$, the doubling $\Xi$ of $\Sigma_x$ is $\Alex1$.
Denote by $\xi_0$ and $\xi_1$ the points in $\Xi$ that correspond to $\xi$.
Observe that $\dist{\xi_0}{\xi_1}{\Xi}>\pi$.
The latter contradicts \ref{ex:RisCBB(1)}.

Finally, if $\distfun_{\partial \Sigma_x}(\xi)= \tfrac\pi2$, then $\dist{\xi_0}{\xi_1}{\Xi}=\pi$.
Therefore, $\Cone \Xi$ contains a line in the directions of $\xi_0$ and $\xi_1$;
in other words, $\Xi$ is a spherical suspension with poles $\xi_0$ and $\xi_1$.
In particular, every point of $\Xi$ lies on distance at most $\tfrac\pi2$ from $\xi_0$ or $\xi_1$.
The natural projection $\Xi\to \Sigma_x$ does not increase distances and sends both  $\xi_0$ and $\xi_1$ to $\xi$.
Therefore, the second statement follows.

\parit{\ref{SHORT.thm:doubling:doubling}$_{m-1}+$\ref{SHORT.thm:doubling:concave}$_{m-1}+$\ref{SHORT.thm:doubling:concave}$_m\Rightarrow$\ref{SHORT.thm:partial-grad:grad}$_m$.}
We can assume that $s=\nabla_xf\ne 0$.
By \ref{prop:grad-exist}, $\nabla_xf\z=s\cdot \overline{\xi}$, where $s=\dd_xf(\overline{\xi})>0$ and $\overline{\xi}\in\Sigma_p$ is the direction that maximize $\dd_xf(\overline{\xi})$.

Let $\zeta\in \partial\Sigma_x$ be a direction that minimize the angle $\mangle(\overline{\xi},\zeta)$.
It is sufficient to show that $\zeta=\overline{\xi}$.

Assume $\zeta\ne \overline{\xi}$;
let $\eta=\dir[\Sigma_x]\zeta{\overline{\xi}}$.
By \ref{SHORT.thm:doubling:concave}$_m$, $\mangle(\overline{\xi},\zeta)\le \tfrac\pi2$ and
\ref{SHORT.thm:doubling:concave}$_{m-1}$ implies that 
\[\mangle(\eta,\nu)\le \tfrac\pi2\eqlbl{eq:<pi/2}\]
for any $\nu\in \Sigma_\zeta\Sigma_x$ (if $m=2$, then the last statement is evident). 

Let $\phi\:\Sigma_x\to\RR$ be restriction of $\dd_xf$ to $\Sigma_x$.
Applying \ref{ex:d(distfun):<} and \ref{eq:<pi/2}, we get that $\dd_\xi\phi(\eta)\le 0$.
Since $\dd_xf$ is convex, we have that $\phi''+\phi\le 0$.
If $\phi(\zeta)\le 0$, then it implies that $\phi(\overline{\xi})\le 0$ --- a contradiction.
If $\phi(\zeta)> 0$, then $\phi(\overline{\xi})<\phi(\zeta)$ --- a contradiction again.

\parit{\ref{SHORT.thm:partial-grad:grad}$_m\Rightarrow$\ref{SHORT.thm:partial-grad:flow}$_m$.}
Let $\alpha$ be an $f$-gradient curve and $\ell(t)=\distfun_{\partial \spc{A}}\alpha(t)$.

Choose $t$;
let $x=\alpha(t)$ and $y\in \partial\spc{A}$ be a closest point to $x$.
By \ref{SHORT.thm:partial-grad:grad}$_m$, we have that $\nabla_y f\in\partial \T_y$.
Since the distance $\dist{x}{y}{}$ is minimal, 
we get $\langle \dir yx,v\rangle\le 0$ for any $v\in \partial \T_y$.
In particular,
\[\langle \dir yx,\nabla_y f\rangle\le 0\]
Applying Exercise~\ref{ex:monotonicity} to $x$ and $y$, 
we get
\[\ell'(t)\le \ell(t)\]
if the left-hand side is defined.
Since $\ell$ is Lipschitz, $\ell'$ is defined almost everywhere.
Integrating the inequality, we get 
\[\ell(t)\le e^t\cdot\ell(0)\]
for any $t\ge 0$.
In particular, if $\ell(0)=0$, then $\ell(t)=0$ for any $t\ge 0$.
Since $\partial\spc{A}$ is closed (\ref{ex:bry-closed}), the statement follows.

\parit{\ref{SHORT.thm:partial-grad:flow}$_{m}+$\ref{SHORT.thm:doubling:doubling}$_{m-1}\Rightarrow$\ref{SHORT.thm:doubling:doubling}$_m$.}
We will consider the case $\kappa=0$;
other cases can be done in the same way, but formulas get more complicated.

Denote by $\spc{A}_0$ and $\spc{A}_1$ the two copies of $\spc{A}$ in $\spc{W}$;
let us keep the notation $\partial \spc{A}$ for the common boundary of $\spc{A}_0$ and $\spc{A}_1$.

\begin{clm}{}
Let $\gamma$ be a geodesic in $\spc{W}$.
Then either $\gamma$ has at most one interior point in $\partial \spc{A}$ or
$\gamma\subset \partial \spc{A}$.
\end{clm}

\begin{wrapfigure}{r}{45mm}
\vskip-2mm
\centering
\includegraphics{mppics/pic-1315}
\end{wrapfigure}

Indeed, assume $\gamma$ shares at least two points with $\partial \spc{A}$, say $x=\gamma(t_1)$ and $y=\gamma(t_2)$ and these are not endpoints of $\gamma$.
Remove from $\gamma$ the set $\gamma\cap \spc{A}_1$
and exchange it to its reflection across $\partial\spc{A}$;
denote the obtained curve by $\hat\gamma$.

Note that any arc of $\hat\gamma$ with one endpoint in $\partial \spc{A}$
is a geodesic in $\spc{A}_0$.
Since $x,y\in \partial \spc{A}$, the arc of $\hat\gamma$ behind $y$ lies in the image of map $t\mapsto \GF^t_{f_x}(y)$, where $f_x=\tfrac12\cdot\distfun^2_x$.
By \ref{SHORT.thm:partial-grad:flow}, this arc lies in $\partial\spc{A}$.

Now choose a point $z$ on this arc, so $z\in \partial\spc{A}$.
Applying the same argument, we get that the arc of $\hat\gamma$ before $y$ lies in $\partial\spc{A}$.
Hence the claim follows.\claimqeds

Choose a point $p$ in $\spc{W}$;
let $f\df\tfrac12\cdot\distfun_p^2$.
It is sufficient to show that $(f\circ\gamma)''\le 1$ for any $t$.
If $p\in \partial\spc{A}$, then the statement follows from function comparison in $\spc{A}_0$ and $\spc{A}_1$.
So, we can assume that $p\in \spc{A}_0\setminus \partial\spc{A}$.

If $\gamma$ lies in $\partial \spc{A}$, then this inequality follows from the comparison in~$\spc{A}_0$.

\begin{wrapfigure}{r}{55mm}
\vskip-2mm
\centering
\includegraphics{mppics/pic-1325}
\end{wrapfigure}

Choose $y=\gamma(t_0)$; without loss of generality we can assume that $t_0=0$.

If $y\z\in \spc{A}_0\setminus\partial\spc{A}$, then $(f\z\circ\gamma)''(0)\le 1$ in the barrier sense;
it follows from the comparison in $\spc{A}_0$.

Assume $y\in \spc{A}_1\setminus\partial\spc{A}$.
Suppose $[py]$ crosses $\partial\spc{A}$ at $x$.
Let $\Sigma_x$ be the space of directions of $\spc{A}$ at $x$,
and let $\Xi$ be its doubling.
As before, we denote by $\Sigma_0$ and $\Sigma_1$ two copies of $\Sigma_x$ in  $\Xi$
and keep notation $\partial\Sigma_x$ for their common boundary.
By \ref{SHORT.thm:doubling:doubling}$_{m-1}$, $\Xi$ is $\Alex1$.

Note that $\dir x{y}$ and $\dir xp$ lie in opposite sides of $\Xi$ and
\[\dist{\dir x{y}}{\dir xp}\Xi\ge \pi.\]
Otherwise, we could choose a direction $\xi\in\partial\Sigma$ such that
\[\dist{\dir x{y}}{\xi}\Xi+\dist{\xi}{\dir xp}\Xi<\pi.\]
Furthermore, we could consider the radial curve $\alpha(t)=\gexp_x(t\cdot \xi)$.
By \ref{SHORT.thm:partial-grad:flow}$_m$, $\alpha$ lies in $\partial \spc{A}$.
By \ref{prop:gexp}
\[\dist{p}{\alpha(s)}{\spc{A}_0}
+\dist{y}{\alpha(s)}{\spc{A}_1}
<\dist{p}{y}{\spc{W}}\]
for small values $s>0$
--- a contradition.

Note that $\Cone \Xi$ contains a line with directions $\dir x{y}$ and $\dir xp$.
By splitting theorem $\Cone \Xi$ split in these directions;
in particular, 
\[\dist{\dir x{y}}{\xi}{}+\dist{\xi}{\dir xp}{}=\pi.\]
for any $\xi\in\Xi$.
It follows that for any $\xi\in\Xi$ there is $\xi'\in\partial\Sigma_x$ such that 
$\xi$ and $\xi'$ lie on some geodesic $[\dir x{y} \dir xp]_\Xi$.

Fix $t\approx 0$ such that $t\ne 0$; let $z=\gamma(t)$.
Choose such $\xi'$ for $\xi=\dir xz$.
Consider the radial curve $\alpha(s)\df\gexp_x(s\cdot\xi')$.
Let us show that 
\[
\begin{aligned}
\dist{p}{z}{\spc{W}}
&\le \dist{p}{\alpha(s)}{\spc{A}_0}+ \dist{\alpha(s)}{z}{\spc{A}_1}\le
\\
&\le\side\hinge yp{z}.
\end{aligned}
\eqlbl{eq:gamma''}
\]
for suitable value $s$.

The first inequality in \ref{eq:gamma''} is evident.
Set $\phi=\mangle\hinge{x}{y}{z}$ and $\psi\z=\mangle(\dir xp,\xi')$.
The choice of $s$ comes from the model configuration $\tilde p$, $\tilde x$, $\tilde y$, $\tilde w$, $\tilde z\in \EE^2$ such that
\begin{align*}
\tilde x&\in [\tilde p\tilde y],
&
\dist{\tilde p}{\tilde x}{}&=\dist{ p}{x}{},
&
\dist{\tilde p}{\tilde y}{}&=\dist{p}{y}{},
&
\dist{\tilde x}{\tilde z}{}&=\dist{x}{z}{},
\\
\tilde w&\in [\tilde p\tilde z],
&
\mangle\hinge{\tilde x}{\tilde y}{\tilde z}&=\phi,
&
\mangle\hinge{\tilde x}{\tilde p}{\tilde w}&=\psi, 
&
s&=\dist{\tilde x}{\tilde w}{}.
\end{align*}
\begin{figure}[ht!]
\vskip-0mm
\centering
\includegraphics{mppics/pic-1014}
\end{figure}

\noindent
By \ref{prop:gexp}, we get 
\begin{align*}
\dist{p}{\alpha(s)}{\spc{A}_0}&\le \dist{\tilde p}{\tilde w}{},
\\
\dist{\alpha(s)}{z}{\spc{A}_1}&\le\dist{\tilde w}{\tilde z}{};
\end{align*}
by the comparison, 
\[\dist{\tilde p}{\tilde z}{}\le \side\hinge ypz.\]

\begin{thm}{Exercise}\label{ex:pz<ypz}
Prove the last inequality.
\end{thm}

Hence we get $(f\circ\gamma)''(0)\le 1$ in the barrier sense.

Finally if $\gamma(0)\in\partial\spc{A}$, then splitting argument shows that 
\[(f\circ\gamma)^+(0)+(f\circ\gamma)^-(0)\le 0.\]

Summarizing, we get that $(f\circ\gamma)''\le 1$ on every arc of $\gamma$ that lies entirely in $\spc{A}_0$ or $\spc{A}_1$.
If $\gamma$ crosses $\partial \spc{A}$, then we know that it happens only once and at the crossing moment $t_0$ 
we have $f\circ\gamma^+(t_0)\z+f\circ\gamma^-(t_0)\z\le 0$.
All this implies that $(f\circ\gamma)''\le 1$.
\qeds

\begin{thm}{Exercise}\label{ex:bry-connected}
Let $\spc{A}$ be a finite-dimensional $\Alex1$ space of dimension $\ge 2$ with non-empty boundary $\partial\spc{A}$.
Show that $\partial\spc{A}$ is connected.
\end{thm}


\begin{thm}{Exercise}\label{ex:dist-to-bry}
Let $\spc{A}$ be an $m$-dimensional $\Alex0$ space with non-empty boundary $\partial\spc{A}$
for $2\le m<\infty$.
Show that the distance function to the boundary
\[\distfun_{\partial\spc{A}}\:\spc{A}\to\RR\]
is concave.
\end{thm}

\begin{thm}{Exercise}\label{ex:liberman}
Let $\spc{A}$ be a finite-dimensional $\Alex0$ space with non-empty boundary $\partial\spc{A}$.
Suppose $\gamma$ is a geodesic in $\partial\spc{A}$ with the induced length metric.
Show that the function $t\mapsto \tfrac12\cdot\distfun_p^2\circ\gamma(t)$ is 1-concave for any point $p$. 
\end{thm}

\begin{thm}{Exercise}\label{ex:native}
Let $\spc{W}$ be a doubling of finite-dimensional Alexandrov space $\spc{A}$ across its boundary,
and let $proj\:\spc{W}\to\spc{A}$ be the natural projection.
Suppose $f\:\spc{A}\to\RR$ is a $\lambda$-concave function.
Show that $f\circ\proj\:\spc{W}\to\RR$ is $\lambda$-concave if and only if $\nabla_xf\in \partial \T_x$ 
for any $x\in\partial \spc{A}$.
\end{thm}



\section{Remarks}

Note that the doubling of a finite-dimensional Alexandrov space across its boundary results in an Alexandrov space without boundary.
This observation can often be used to reduce a statement about general finite-dimensional Alexandrov spaces to  Alexandrov spaces without boundary.

For spaces without boundary the following tools become available.

\begin{thm}{Fundamental-class lemma}\label{lem:fund-class}
Any compact finite-dimensional Alexandrov space $\spc{A}$ without boundary has a fundamental class with $\ZZ/2$ coefficients;
that is, if $\spc{A}$ is $m$-dimensional, then
\[H^m(\spc{A},\ZZ/2)=\ZZ/2.\]

\end{thm}

This lemma was proved by Karsten Grove and Peter Petersen \cite{grove-petersen}.
Originally it was stated for Alexander--Spanier cohomology. We do not make this distinction  because for compact Alexandrov spaces it is the same as singular cohomology. Indeed,  both cohomology theories are homotopy invariant \cite[Chapter 6]{Spanier}, compact Alexandrov spaces are homotopy equivalent to finite simplicial complexes and  for paracompact  CW complexes  Alexander--Spanier cohomology is isomorphic to \v{C}ech  and singular cohomolgy \cite[Chapter 6]{Spanier}.

This lemma implies, for example, that on finite-dimensional Alexandrov spaces without boundary 
the gradient flow for a $\lambda$-concave function is an onto map;
in other words, gradient curves can be extended into the past.
It is also used in the proof of the following version of the domain invariance theorem \cite[Theorem 3.2]{kapovitch-zhu}.

\begin{thm}{Domain invariance}\label{thm-inv-domain}
Let $\spc{A}_1$ and $\spc{A}_2$ be two $m$-dimensional Alexandrov spaces with empty boundary; $m$ is finite.
Suppose $\Omega_1$ is an open subset in $\spc{A}_1$ and $f\:\Omega_1\to \spc{A}_2$ is an injective continuous map.
Then $f(\Omega_1)$ is open in $\spc{A}_2$.
\end{thm}

Theorem~\ref{thm:spherical-nbhd} can be used to prove the following. 

\begin{thm}{Topological stratification}\label{thm:top-stratification}
Any $m$-dimensional Alexandrov space with $m<\infty$ can be subdivided into topological manifolds $S_0,\z\dots,S_m$ such that for every $i$ we have $\dim S_i=i$ or $S_i=\emptyset$.
Moreover,
\begin{subthm}{}
the closure of $S_{m-1}$ is the boundary of the space, and
\end{subthm}

\begin{subthm}{}
$S_{m-2}=\emptyset$.
\end{subthm}

\end{thm}

Let us mention that this statement implies that a compact finite-dimensional Alexandrov space has the homotopy type of a finite CW complex,
but it seems to be unknown if it has to be homeomorphic to a CW complex.

The stratification theorem~\ref{thm:top-stratification} can be sharpened as follows.

\begin{thm}{Boundary characterization}
Let $\spc{A}$ be an $m$-dimensional Alexandrov space with $m<\infty$.
Then the following statements are equivalent.

\begin{subthm}{item-boundary} $p\in \partial \spc{A}$;
\end{subthm}

\begin{subthm}{item-contractible} $\Sigma_p$ is contractible;
\end{subthm}

\begin{subthm}{item-space-dir-homology} $\tilde H_{m-1}(\Sigma_p,\ZZ/2)= 0$;
\end{subthm}

\begin{subthm}{item-local-homology} $H_m(\spc{A},\spc{A}\setminus \{p\},\ZZ/2)= 0$;
\end{subthm}

\end{thm}

Let $f$ be a semiconcave function.
A point $p\in \Dom f$ is called \index{critical point}\emph{critical} point of $f$ if $\dd_pf\le 0$; 
otherwise it is called \index{regular point}\emph{regular}.

The following statement plays a technical role in the proof of stability theorem,
but it is also a useful technical tool on its own.

\begin{thm}{Morse lemma}
Let $f$ be a semiconcave function on a finite-dimensional Alexandrov space without boundary.
Suppose $K$ is a compact set of regular points of $f$ in its level set $f=a$.
Then an open neighborhood $\Omega$ of $K$ admits a homeomorphism $x\mapsto (h(x),f(x))$ to a product space $\Lambda\times (a-\eps,a+\eps)$.
\end{thm}

Subsets in Alexandrov spaces that satisfy the condition in \ref{thm:partial-grad:flow} are called extremal.
More precisely, a subset $E$ is \index{extremal set}\emph{extremal} if for any $x\in E$
and $f$-gradient curve that starts in $E$ remains in $E$;
here $f$ is arbitrary function of the form $\tfrac12\cdot \distfun_p^2$. %{\red V: should we add the condition that $E$ is closed?} A: No, it follows.}

Extremal subsets were introduced by Grigory Perelman and the second author \cite{perelman-petrunin}.
They will pop up in the next lecture.

The following conjecture is one of the oldest questions in Alexandrov geometry that remains open.

\begin{thm}{Conjecture}
Let $S$ be a component of the boundary of a finite-dimensional Alexandrov space.
Then $S$ equipped with the induced length metric is an Alexandrov space with the same curvature bound.
\end{thm}

The doubling theorem has several generalization \cite{petrunin1997,ge-li} that allows to glue nonidentical spaces.
