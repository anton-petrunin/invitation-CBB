%%!TEX root = the-splitting.tex
\chapter{Line splitting}\label{chap:splitting}

\section{Busemann function}

A \index{half-line}\emph{half-line} \footnote{\red V: we used half-line in the other book but I would still like to change this to "ray" which is the established term in literature} is a distance-preserving map
from $\RR_{\ge0}=[0,\infty)$ 
to a metric space.
In other words, a half-line is a geodesic defined on the real half-line $\RR_{\ge0}$.
If $\gamma\:[0,\infty)\to \spc{X}$ is a half-line,
then the limit 
\[\bus_\gamma(x)=\lim_{t\to\infty}\dist{\gamma(t)}{x}{}- t\eqlbl{eq:def:busemann*}\]
is called the \index{Busemann function}\emph{Busemann function} of $\gamma$.

The Busemann function $\bus_\gamma$ mimics behavior of the distance function from the ideal point of $\gamma$.

\begin{thm}{Proposition}\label{prop:busemann}
For any half-line $\gamma$ in a metric space $\spc{X}$,
its Busemann function $\bus_\gamma\:\spc{X}\to \RR$ 
is defined.
Moreover, $\bus_\gamma$ is $1$-Lipschitz and $\bus_\gamma (\gamma(t))=-t$ for any $t$.

\end{thm}

\parit{Proof.}
By the triangle inequality, the function
\[t\mapsto\dist{\gamma(t)}{x}{}- t\] 
is nonincreasing for any fixed $x$.  

Since $t=\dist{\gamma(0)}{\gamma(t)}{}$, the triangle inequality implies that
\[\dist{\gamma(t)}{x}{}- t\ge-\dist{\gamma(0)}{x}{}.\]
Thus the limit in \ref{eq:def:busemann*} is defined,
and it is 1-Lipschitz as a limit of 1-Lipschitz functions.
The last statement follows since 
$\dist{\gamma(t)}{\gamma(t_0)}{}\z=t-t_0$ for all large~$t$.
\qeds

\begin{thm}{Exercise}\label{ex:busemann-CBB}
Any Busemann function on an $\Alex0$ space is concave.
\end{thm}

\section{Splitting theorem}

A \index{line}\emph{line} is a distance-preserving map
from $\RR$ to a metric space.
In other words, a line is a geodesic defined on the real line $\RR$.

\begin{thm}{Exercise}\label{ex:bus+bus}
Let $\gamma$ be a line in a metric space $\spc{X}$.
Show that for any point $x$ we have
\[\bus_+(x)+\bus_-(x)\ge 0\]
where, $\bus_+$ and $\bus_-$, are the Busemann functions asociated with half-lines $\gamma:[0,\infty)\to \spc{L}$ and $\gamma:(-\infty,0]\to \spc{L}$ respectively.
\end{thm}


Let $\spc{X}$ be a metric space and $A,B\subset \spc{X}$.
We will write 
\[\spc{X}=A\oplus B\]\index{$A\oplus B$}
if there are projections $\proj_A\:\spc{X}\to A$ 
and 
$\proj_B\:\spc{X}\to B$
such that 
\[\dist[2]{x}{y}{}=\dist[2]{\proj_A(x)}{\proj_A(y)}{}+\dist[2]{\proj_B(x)}{\proj_B(y)}{}\]
for any two points $x,y\in \spc{X}$.

Note that if 
\[\spc{X}=A\oplus B\]
then 
\begin{itemize}
\item $A$ intersects $B$ at a single point,
\item both sets $A$ and $B$ are convex sets in $\spc{X}$;
the latter means that any geodesic with the ends in $A$ (or $B$) lies in $A$ (or $B$). 
\end{itemize}

\begin{thm}{Line splitting theorem}\label{thm:splitting}
Let $\gamma$ be a line in a $\Alex0$ space $\spc{L}$. 
Then 
\[\spc{L}=\spc{L}'\oplus \gamma(\RR)\]
for some subset $\spc{L}'\subset \spc{L}$.
\end{thm}

Before going into the proof, let us state a corollary of the theorem.

\begin{thm}{Corollary}\label{cor:splitting}
Any $\Alex0$ space $\spc{L}$ splits isometrically as
\[
\spc{L}=\spc{L}'\oplus H
\]
where $H\subset \spc{L}$ is a subset isometric to a Hilbert space, and $\spc{L}'\subset \spc{L}$ is a convex subset that contains no lines. 
\end{thm}

The following lemma is closely related to the first distance estimate (\ref{thm:dist-est}); its proof goes along the same lines.

\begin{thm}{Lemma}\label{lem:dist-estimate}
Suppose $f\:\spc{L}\to\RR$ be a concave 1-Lipschitz function on an $\Alex0$ space $\spc{L}$.
Consider two $f$-gradient curves $\alpha$ and~$\beta$.
Then for any $t, s\ge 0$ we have
\begin{align*}
&\dist[2]{\alpha(s)}{\beta(t)}{}
\le 
\dist[2]{p}{q}{}+
2\cdot(f(p)-f(q))\cdot(s-t)+ (s-t)^2,
\end{align*}
where $p=\alpha(0)$ and $q=\beta(0)$.
\end{thm}

\parit{Proof.}
Since $f$ is 1-Lipschitz, $|\nabla f|\le1$.
Therefore 
\[f\circ\beta(t)\le f(q)+t\]
for any $t\ge0$.

Set $\ell(t)=\dist{p}{\beta(t)}{}$.
Applying \ref{eq:fist-var-inq+}, we get
\begin{align*}
(\ell^2)^+(t)
&\le 2\cdot \left(f\circ\beta(t)-f(p)\right)\le 
\\
&\le2\cdot\left(f(q)+t-f(p)\right).
\end{align*}
Therefore 
\[\ell^2(t)-\ell^2(0)\le 2\cdot\left(f(q)-f(p)\right)\cdot t + t^2.\]
It proves the needed inequality in case $s=0$.
Combining it with the first distance estimate (\ref{thm:dist-est}), we get the result in case $s\le t$.
The case $s\ge t$ follows by switching the roles of $s$ and $t$.
\qeds


\parit{Proof of \ref{thm:splitting}.} Consider two Busemann functions, $\bus_+$ and $\bus_-$, asociated with half-lines $\gamma:[0,\infty)\to \spc{L}$ and $\gamma:(-\infty,0]\to \spc{L}$ respectively; that is,
\[
\bus_\pm(x)
\df
\lim_{t\to\infty}\dist{\gamma(\pm t)}{x}{}- t.
\]
According to \ref{ex:busemann-CBB}, 
both functions $\bus_\pm$ are concave.

By \ref{ex:bus+bus}, $\bus_+(x)+\bus_-(x)\ge0$ for any $x\in \spc{L}$.
On the other hand, by \ref{comp-kappa}, 
$f(t)=\distfun_x^2\circ\gamma(t)$ 
is $2$-concave.
In particular, $f(t)\le t^2+at+b$ for some constants $a,b\in\RR$.  Therefore, for all large $t$
\[
\dist{\gamma( t)}{x}{}- t +\dist{\gamma(- t)}{x}{}- t\le \sqrt{ t^2+at+b}-t+\sqrt{ t^2-at+b}-t
\]

Passing to the limit as $t\to\infty$, we get that  $\bus_+(x)+\bus_-(x)\le 0$.
Hence
\[
\bus_+(x)+\bus_-(x)= 0
\]
for any $x\in \spc{L}$.
In particular, the functions $\bus_\pm$ are \index{affine function}\emph{affine};
that is, they are convex and concave at the same time.

Note that for any $x$,
\begin{align*}
|\nabla_x \bus_\pm|
&=\sup\set{\dd_x\bus_\pm(\xi)}{\xi\in\Sigma_x}=
\\
&=\sup\set{-\dd_x\bus_\mp(\xi)}{\xi\in\Sigma_x}\equiv
\\
&\equiv1.
\end{align*}

Observe that $\alpha$ is a $\bus_\pm$-gradient curve
if and only if $\alpha$ is a geodesic such that $(\bus_\pm\circ\alpha)^+=1$.
Indeed, if $\alpha$ is a geodesic, then $(\bus_\pm\circ\alpha)^+\le 1$ and the equality holds only if $\nabla_\alpha\bus_\pm=\alpha^+$.
Now suppose $\nabla_\alpha\bus_\pm=\alpha^+$.
Then $|\alpha^+|\le 1$ and $(\bus_\pm\circ\alpha)^+=1$; therefore 
\begin{align*}
|t_0-t_1|&\ge \dist{\alpha(t_0)}{\alpha(t_1)}{}\ge
\\
&\ge|\bus_\pm\circ\alpha(t_0)-\bus_\pm\circ\alpha(t_1)=
\\
&=|t_0-t_1|.
\end{align*}

It follows that for any $t>0$, the $\bus_\pm$-gradient flows commute;
that is, 
\[\GF_{\bus_+}^t\circ\GF_{\bus_-}^t=\id_\spc{L}.\]
Setting
\[\GF^t=\left[\begin{matrix}
\GF_{\bus_+}^t&\hbox{if}\ t\ge0\\
\GF_{\bus_-}^t&\hbox{if}\ t\le0
               \end{matrix}\right.\]
defines an $\RR$-action on $\spc{L}$.

Consider the level set $\spc{L}'=\bus_+^{-1}(0)=\bus_-^{-1}(0)$;
it is a closed convex subset of $\spc{L}$, and therefore forms an Alexandrov space.
Consider the map $h\:\spc{L}'\times \RR\to \spc{L}$ defined by $h\:(x,t)\mapsto \GF^t(x)$.
Note that $h$ is onto.
Applying Lemma \ref{lem:dist-estimate} for $\GF_{\bus_+}^t$ and $\GF_{\bus_-}^t$ shows that $h$ is short and non-contracting at the same time; that is, $h$ is an isometry.
\qeds

Recall that according our definition the real line $\RR$ is $\Alex1$.
However most of $\Alex1$ spaces have diameter at most $\pi$;
see \ref{ex:RisCBB(1)}.

\begin{thm}{Exercise}\label{ex:cone-CBB}
Suppose $\spc{X}$ is a complete geodesic space.
Show that $\Cone\spc{X}$ is $\Alex0$ if and only if $\spc{X}$ is $\Alex1$ and $\diam\spc{X}\le \pi$.
\end{thm}

\section{Comments}

The splitting theorem has an interesting history that starts with Stefan Cohn-Vossen \cite{cohn-vossen_line};
he proved it for smooth $2$-dimensional surfaces.
For Riemannian manifolds of higher dimensions 
it was proved by Victor Toponogov \cite{toponogov-globalization+splitting}.
Then it was generalized by Anatoliy Milka \cite{milka-line}
to Alexandrov spaces; nearly the same proof is used in \cite[1.5]{burago-burago-ivanov}.

Further generalizations of the splitting theorem for Riemannian manifolds with nonnegative Ricci curvature were obtained by Jeff Cheeger and Detlef Gromoll \cite{cheeger-gromoll-split}.
This was further generalized by Jeff Cheeger and Toby Colding for limits of Riemannian manifolds with almost nonnegative Ricci curvature \cite{cheeger-colding-alm-rigidity} and to their synthetic generalizations, so-called {}\emph{RCD spaces}, by Nicola Gigli \cite{gigli2013splitting, gigli-splitting-overview}.
Jost-Hinrich Eschenburg obtained an analogous result for  Lorentzian manifolds \cite{eshenburg-split}, that is, pseudo-Riemannian manifolds of signature $(1,n)$.

The presented proof is close in spirit to the proof given in \cite{cheeger-gromoll-split};
it is taken from our book \cite{alexander-kapovitch-petrunin2024}.

\chapter{Dimension}\label{chap:dim}

\section{Polar vectors}

Here we give a corollary of \ref{ex:convergence-grad}.
It will be used to prove basic properties of the tangent space.


\begin{thm}{Anti-sum lemma}\label{lem:minus-sum} 
Let $\spc{L}$ be an Alexandrov space and $p\in \spc{L}$.

Given two vectors $u,v\in \T_p$, there is a unique vector $w\in \T_p$ such that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle \ge 0\]
for any $x\in \T_p$, and
\[\langle u,w\rangle +\langle v,w\rangle +\langle w,w\rangle =0.\]

\end{thm}

\begin{thm}{Exercise}\label{ex:|antisum|}
Suppose $u,v, w\in \T_p$ are as in \ref{lem:minus-sum}.
Show that 
\[|w|^2\le |u|^2+|v|^2+2\cdot\langle u,v\rangle.\]

\end{thm}


If $\T_p$ were geodesic, then the lemma would follow from the existence  of the gradient, applied to the function $\T_p\to \RR$ defined by $x\mapsto -(\langle u,x\rangle +\langle v,x\rangle )$ which is concave.
However, the tangent space $\T_p$ might fail to be geodesic; see  Halbeisen's example \cite{alexander-kapovitch-petrunin2024}.


Applying the above lemma for $u=v$, we have the following statement.

\begin{thm}{Existence of polar vector}\label{cor:polar}
Let $\spc{L}$ be an Alexandrov space 
and $p\in \spc{L}$. 
Given a vector $u\in \T_p$,  there is a unique vector $u^*\in\T_p$ such that $\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0$ and
$u^*$ is \index{polar vectors}\emph{polar} to $u$;
that is,
 $\langle u^*,x\rangle +\langle u,x\rangle \ge 0$ for any $x\in \T_p$.

In particular, for any vector $u\in \T_p$ there is a polar vector $u^*\in\T_p$ such that
$|u^*|\le |u|$.
\end{thm}

\begin{thm}{Example}
Let $\spc{L}$ be the upper half plane in $\EE^2$;
that is, $\spc{L}\z=\{(x,y)\in \EE^2\mid y\ge 0\}$.
It is an Alexandrov space.
For $p=0$, the tangent space $\T_p$ can be canonically identified with $\spc{L}$.
If $y>0$, then $u=(x,y)\in \T_p$ has many polar vectors;
it includes $u^*=(-x,0)$ which is provided by \ref{cor:polar},
but the vector $w=(-x,y)$ is polar as well.
\end{thm}

\parit{Proof of \ref{lem:minus-sum}.}
By \ref{ex:first-var-CBB}, we can choose two sequences of points $a_n,b_n$ such that 
\begin{align*}
\dd_p\distfun_{a_n}(w)&=-\langle\dir{p}{a_n},w\rangle
\\
\dd_p\distfun_{b_n}(w)&=-\langle\dir{p}{b_n},w\rangle
\end{align*}
for any $w\in\T_p$ and $\dir{p}{a_n}\to u/|u|$, $\dir{p}{b_n}\to v/|v|$ as $n\to \infty$

Consider a sequence of functions 
\[f_n=|u|\cdot\distfun_{a_n}+|v|\cdot\distfun_{b_n}.\]
Note that 
\[(\dd_pf_n)(x)=-|u|\cdot\langle \dir{p}{a_n},x\rangle -|v|\cdot\langle \dir{p}{b_n},x\rangle .\]
Thus we have the following uniform convergence for $x\in\Sigma_p$:
\[(\dd_pf_n)(x)\to-\langle u,x\rangle -\langle v,x\rangle \]
as $n\to\infty$,
According to \ref{ex:convergence-grad}, 
the sequence $\nabla_pf_n$ converges.
Let 
\[w=\lim_{n\to\infty}\nabla_pf_n.\]
By the definition of gradient,
\[\begin{aligned}
\langle w,w\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,\nabla_pf_n\rangle =
&&&%right side
\langle w,x\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,x\rangle \ge
\\%second line
&=\lim_{n\to\infty}(\dd_p f_n)(\nabla_p f_n)
=
&&&%second line right side
&\ge
\lim_{n\to\infty}(\dd_pf_n)(x)
=
\\%line 3
&=-\langle u,w\rangle -\langle v,w\rangle ,
&&&%line 3 right side
&=-\langle u,x\rangle -\langle v,x\rangle .
\end{aligned}\]
\qedsf












\section{Linear subspace of tangent space}

\begin{thm}{Definition}\label{def:opp+Lin}
Let $\spc{L}$ be an Alexandrov space, $p\in \spc{L}$ and $u,v\in\T_p$.
We say that vectors $u$ and $v$ are \index{opposite vectors}\emph{opposite}\label{def:opposite:page} to each other, (briefly, $u+v=0$) if $|u|=|v|=0$ or $\mangle(u,v)=\pi$ and $|u|=|v|$.

The subcone
\[\Lin_p=\set{v\in\T_p}{\exists\ w\in\T_p\quad \text{such that}\quad w+v=0}\]
will be called the \index{linear subspace}\emph{linear subspace} of $\T_p$.
\end{thm}

\begin{thm}{Proposition}\label{prop:opposite}
Let $\spc{L}$ be an Alexandrov space and $p\in \spc{L}$.
Given two vectors $u,v\in\T_p$, the following statements are equivalent:
\begin{subthm}{opposite} $u+v=0$;
\end{subthm}
\begin{subthm}{<x,u>} $\langle u,x\rangle +\langle v,x\rangle =0$ for any $x\in\T_p$;
\end{subthm}
\begin{subthm}{<xi,u>} $\langle u,\xi\rangle +\langle v,\xi\rangle =0$ for any $\xi\in\Sigma_p$.
\end{subthm}
\end{thm}

\parit{Proof.}
The equivalence  \ref{SHORT.<x,u>}$\Leftrightarrow$\ref{SHORT.<xi,u>} is trivial.

The condition $u+v=0$ is equivalent to 
\[\langle u,u\rangle =-\langle u,v\rangle =\langle v,v\rangle ;\]
thus 
\ref{SHORT.<x,u>}$\Rightarrow$\ref{SHORT.opposite}.

Recall that $\T_p$ has nonnegative curvature.
Note that the hinges $\hinge 0ux$ and $\hinge 0vx$ are adjacent.
By \ref{ex:adjacent-CBB}, $\mangle\hinge 0ux+\mangle\hinge 0vx=\pi$;
hence \ref{SHORT.opposite}$\Rightarrow$\ref{SHORT.<x,u>}.
\qeds

\begin{thm}{Exercise}\label{prop:two-opp}
Let $\spc{L}$  be an Alexandrov space and $p\in \spc{L}$.
Then for any three vectors $u,v,w\in\T_p$, if $u+v=0$ and $u+ w=0$ then $v=w$.
\end{thm}

Let $u\in \Lin_p$; that is, $u+v=0$ for some $v\in\T_p$.
Given $s<0$, let 
\[s\cdot u\df (-s)\cdot v.\]
So we can multiply any vector in $\Lin_p$ by any real number (positive and negative).
By \ref{prop:two-opp}, this multiplication is uniquely defined;
by \ref{prop:opposite}; we have identity
\[\langle -v,x\rangle=-\langle v,x\rangle;\]
later we will see that it extends to a linear structure on $\Lin_p$.

\begin{thm}{Exercise}\label{ex:3<,>=0}
Suppose $u,v,w\in\T_p$ are as in \ref{lem:minus-sum}.
Show that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle = 0\]
for any $x\in \Lin_p$.
\end{thm}

\begin{thm}{Exercise}\label{ex:-u}
Let $\spc{L}$ be an Alexandrov space,
$p\in \spc{L}$ and $u\in \T_p$.
Suppose $u^*\in \T_p$ is provided by \ref{cor:polar};
that is, 
\[\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0
\quad\text{and}\quad
\langle u^*,x\rangle +\langle u,x\rangle \ge 0
\]
for any $x\in \T_p$.
Show that 
\[u=-u^*\quad\Longleftrightarrow\quad|u|=|u^*|.\]
\end{thm}


\begin{thm}{Theorem}\label{thm:lin-subcone}
Let $p$ be a point in an Alexandrov space. 
Then $\Lin_p$ is isometric to a Hilbert space.
\end{thm}

\parit{Proof.}
Note that $\Lin_p$ is a closed subset of $\T_p$;
in particular, it is complete.

If any two vectors in $\Lin_p$ can be connected by a geodesic in $\Lin_p$,
then the statement follows from the splitting theorem (\ref{thm:splitting}).
By Menger's lemma (\ref{lem:mid>geod}), it is sufficient to show that for any two vectors $x,y\in\Lin_p$
there is a midpoint $w\in \Lin_p$.

Choose $w\in \T_p$ to be the anti-sum of $u=-\tfrac{1}{2}\cdot x$ and $v=-\tfrac{1}{2}\cdot y$;
see \ref{lem:minus-sum}.
By \ref{ex:|antisum|} and \ref{ex:3<,>=0},
\begin{align*}
|w|^2&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,x\rangle&= \tfrac12\cdot|x|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,y\rangle&= \tfrac12\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle,
\end{align*}
It follows that 
\begin{align*}
|x-w|^2
&= |x|^2+|w|^2-2\cdot\langle w,x\rangle\le
\\
&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2-\tfrac12\cdot\langle x,y\rangle=
\\
&=\tfrac14\cdot|x-y|^2.
\end{align*}
That is, $|x-w|\le \tfrac12\cdot|x-y|$, and similarly $|y-w|\le \tfrac12\cdot|x-y|$.
Therefore $w$ is a midpoint of $x$ and $y$.
In addition we get equality 
\[|w|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle.\]

It remains to show that $w\in\Lin_p$.
Let $w^*$ be the polar vector provided by \ref{cor:polar}.
Note that 
\[|w^*|\le |w|,
\quad
\langle w^*,x\rangle+\langle w,x\rangle=0,
\quad
\langle w^*,y\rangle+\langle w,y\rangle=0.
\]
The same calculation as above shows that $w^*$ is a midpoint of $-x$ and $-y$ and 
\[|w^*|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle=|w|^2.\]
By \ref{ex:-u}, $w=-w^*$;
hence $w\in\Lin_p$.
\qeds



\begin{thm}{Exercise}\label{ex:grad-dist}
Let $p$ be a point in an Alexandrov space $\spc{L}$ and $f\z=\distfun_p$.
Denote by $S$ the subset of points $x\in\spc{L}$ such that $|\nabla_xf|=1$.

\begin{subthm}{ex:grad-dist:G-delta}
Show that $S$ is a dense G-delta set.
\end{subthm}

\begin{subthm}{ex:grad-dist:lin}
Show that 
\[\nabla_xf+\dir xp=0\]
for any 
$x\in S$;
in particular, $\dir xp\in \Lin_x$.
\end{subthm}

\begin{subthm}{ex:grad-dist:|grad|=1}
Show that if $|\nabla_xf|=1$, then $\dd_xf(w)= \langle\nabla_xf,w\rangle$ for any $w\in \T_x$.
\end{subthm}
\footnote{\red V: I don't like that this is left as an exercise. The statement a) is nontrivial. we give a proof in the other book. I think we should prove it here too}

\end{thm}

Note that \ref{ex:grad-dist} implies the following.

\begin{thm}{Corollary}\label{cor:euclid-subcone}
Given a countable set of points $X$ in an Alexandrov space $\spc{L}$
there is a G-delta dense set $S\subset\spc{L}$
such that 
$\dir sx\in \Lin_s$
for any $s\in S$ and $x\in X$.
\end{thm}

\section{Linear dimension}

Suppose $\spc{L}$ is an Alexandrov space.
Let us define its \index{linear dimension}\emph{linear dimension} $\LinDim \spc{L}$ or $\dim\spc{L}$  as the least upper bound on integers $m$ such that 
the Euclidean space $\EE^m$ is isometric to a subspace of the tangent space $\T_p\spc{L}$ at some point $p\in \spc{L}$.
If not stated otherwise, dimension of an Alexandrov space is its linear dimension.

\begin{thm}{(\textit{n}+1)-comparison}
Let $\spc{L}$ be an $\Alex0$ space.
Then for any finite set of points $p,x_1,\dots,x_n\in \spc{L}$, there is a model configuration 
$\tilde p,\tilde x_1,\dots,\tilde x_n\in \EE^m$ such that 
\[|\tilde p-\tilde x_i|_{\EE^m}=| p- x_i|_{\spc{L}}
\quad\text{and}\quad
|\tilde x_i-\tilde x_j|_{\EE^m}\ge |x_i- x_j|_{\spc{L}}\]
for any $i$ and $j$.
Moreover, we can assume that $m\le \LinDim\spc{L}$. 
\end{thm}

\parit{Proof.}
By \ref{cor:euclid-subcone}, we can choose a point $p'$ arbitrarily close to $p$ so that 
$\Lin_{p'}\ni \dir{p'}{x_i}$ for any $i$.
Let us identify $\EE^m$ with a subspace of $\Lin_{p'}$ spanned by $\dir{p'}{x_1},\dots,\dir{p'}{x_n}$.
Note that $m\le \LinDim\spc{L}$.

Set $\tilde p'=0\in \EE^m$ and $\tilde x_i=\dist{p'}{x_n}{}\cdot\dir{p'}{x_n}\in \EE^m$ for every $i$.
Note that 
\[|\tilde p'-\tilde x_i|_{\EE^m}=| p'- x_i|_{\spc{L}}\]
for every $i$.
Applying the comparison $\mangle\hinge {p'}{x_i}{x_j}\ge \angk {p'}{x_i}{x_j}$, we get
\[|\tilde x_i-\tilde x_j|_{\EE^m}\ge |x_i- x_j|_{\spc{L}}\]
for any $i$ and $j$.
Passing to a limit configuration as $p'\to p$ we get the result.
\qeds

\begin{thm}{Exercise}\label{ex:tangent=Em}
Let $\spc{L}$ be an $\Alex0$ space.
Suppose $\LinDim\spc{L}\z=m<\infty$.
Show that $\T_p\spc{L}\iso \EE^m$ for a G-delta dense set of points $p\in\spc{L}$.
\end{thm}

\begin{thm}{Exercise}\label{ex:dim=1}
Show that a 1-dimensional Alexandrov space is homeomorphic to a 1-dimensional manifold, possibly with nonempty boundary.
\end{thm}


\begin{thm}{Exercise}\label{ex:resporka}
Let $\spc{L}$ be an $\Alex0$ space.

Show that $\LinDim \spc{L}\ge m$ if and only if for some $m+2$ points $p$, $a_0,\z\dots, a_{m}\in \spc{L}$
we have
\[\angk p{a_i}{a_j}>\tfrac\pi2\]
for any pair $i\ne j$.
\end{thm}

\section{Space of directions}

A metric space $\spc{X}$ will be called $\ell$-geodesic 
if any two points $x,y\in\spc{X}$ such that $\dist{x}{y}{}<\ell$ can be connected by a geodesic.
Note that geodesic spaces are $\infty$-geodesic.

\begin{thm}{Theorem}\label{thm:finite-space-of-directions}
Let $\spc{L}$ be a finite-dimensional Alexandrov space.
Then for any point $p\in \spc{L}$, its space of directions $\Sigma_p$ is a compact $\pi$-geodesic space with curvature $\ge1$.
\end{thm}


\begin{thm}{Exercise}\label{ex:finite-tan}
Let $p$ be a point in a finite-dimensional Alexandrov space $\spc{L}$.
Prove the following.
\begin{subthm}{}
The tangent space $\T_p$ is a proper geodesic space.
\end{subthm}

\begin{subthm}{ex:finite-space-of-directions-dim}
$\dim\Sigma_p=\dim\spc{L}-1$.
\end{subthm}

\begin{subthm}{}
If $\dim \spc{L}>1$, then $\Sigma_p$ is geodesic.
\end{subthm}


\end{thm}

Using \ref{ex:finite-space-of-directions-dim}, one can prove results for all finite dimensional Alexandrov spaces via induction on  dimension.
Such proofs will be indicated below.

\parit{Proof of \ref{thm:finite-space-of-directions}.}
Note that \ref{prop:Tan-is-CBB(0)}, \ref{ex:cone-CBB}, and ??? imply that $\Sigma_p$ has curvature $\ge1$.

\parit{Compactness.}
Choose $\eps>0$; suppose $\spc{L}$ is $m$-dimensional.
Assume can choose $n$ directions $\xi_1,\dots, \xi_n\in \Sigma_p$ such that $\mangle(\xi_i,\xi_j)\z>\eps$ for any $i\ne j$.
Without loss of generality, we may assume that each direction is geodesic;
that is, there is a point $x_i\in \spc{L}$ such that $\xi_i=\dir p{x_i}$.

Choose $y_i\in [px_i]$ such that $\dist{p}{y_i}{}=r$ for each $i$ and small fixed $r>0$.
Since $r$ is small, we can assume that $\angk p{y_i}{y_j}>\eps$ for any $i\ne j$.
By \ref{cor:euclid-subcone}, we can choose $p'$ arbitrarily close to $p$ such that $\dir{p'}{y_i}\in \Lin{p'}$ for any $i$.
Since  $\dist{p'}{p}{}$ is small, $\angk {p'}{y_i}{y_j}>\eps$ for any $i\ne j$.
By comparison, 
\[\mangle \hinge{p'}{y_i}{y_j}>\eps.\]
Therefore $n\le \pack_\eps\SSS^{m-1}$.

\footnote{\red V: $\pack_\eps$ is only defined in chapter 8. Give forward reference or move the definition here? }

Since $\SSS^{m-1}$ is compact, $\pack_\eps\SSS^{m-1}<\infty$.
By the definition, the space of directions $\Sigma_p$ is complete. 
Applying \ref{ex:pack-net}, we get that  $\Sigma_p$ is compact.

\parit{Existence of geodesics.}
Now we will show that \textit{if $\Sigma_p$ is compact, then it is $\pi$-geodesic};
we will not use the finiteness of dimension directly.

Choose two geodesic directions $\xi=\dir px$ and $\zeta=\dir py$;
let 
\[\alpha\z=\tfrac12\cdot \mangle \hinge pxy=\tfrac12\cdot \dist{\xi}{\zeta}{\Sigma_p}.\]

Suppose $\alpha<\pi/2$.
Let us show that it is sufficient to construct an \index{almost midpoint}\emph{almost midpoint} $\mu\z=\dir pz$ of $\xi$ and $\zeta$ in $\Sigma_p$;
that is, we need to show that for any $\eps>0$ there is a geodesic $[pz]$ such that
\[\mangle\hinge pxz\le \alpha+\eps
\quad\text{and}\quad
\mangle\hinge pyz\le \alpha+\eps.\]
Indeed, once it is done, the compactness of $\Sigma_p$ can be used to get an actual midpoint for any two directions in $\Sigma_p$.
After that Menger's lemma (\ref{lem:mid>geod}) will finish the proof.

Choose a sequence of small positive numbers $r_n\to0$
Consider sequnces $x_n\z\in [px]$ and $y_n\z\in [py]$ such that $\dist{p}{x_n}{}=\dist{p}{y_n}{}=r_n$.
Let $m_n$ be a midpoint of $[x_n\,y_n]$.
%??? we use here that the directions $\xi=\dir px$ and $\zeta=\dir py$ are not opposite???

Since $\Sigma_p$ is compact, we can pass to a sequence of $r_n$ such that 
$\dir{p}{m_n}$ converges;
denote its limit by $\mu$.
Choose a geodesic $[pz]$ that runs at small angle from $\mu$.
Let us show that $\dir pz$ is the needed almost midpoint.

Evidently, $\angk p{x_n}{m_n}=\angk p{y_n}{m_n}$.
By \ref{ex:alex-lemma-cat}, we have
\[\angk p{x_n}{m_n}+\angk p{y_n}{m_n}\le \angk p{x_n}{y_n}.\]

Let $z_n\in [pz]$ be the point such that $\dist{p}{z_n}{}=\dist{p}{m_n}{}$.
By construction, for all large $n$, we have $\mangle\hinge pz{m_n}\approx0$  with arbitrary small given error.
By comparison, the value $\frac{\dist{z_n}{m_n}{}}{\dist{p}{z_n}{}}$ can be assumed to be arbitrary small for all large $n$.
Applying this observation and the definition of angle measure, we also have the following approximations
\begin{align*}
\angk p{x_n}{y_n}&\approx \mangle\hinge p{x_n}{y_n},
\\
\angk p{x_n}{m_n}\approx\angk p{x_n}{z_n}&\approx\mangle\hinge p{x_n}{z_n},
\\
\angk p{m_n}{y_n}\approx\angk p{z_n}{y_n}&\approx\mangle\hinge p{z_n}{y_n},
\end{align*}
again, with arbitrary given error and all large $n$.
It follows that $\dir pz$ is an almost midpoint of $\dir px$ and $\dir py$, as required.
\qeds

Notice that the comparison gives lower bounds on $\mangle\hinge pxz$ and $\mangle\hinge pyz$, but in the proof we needed upper bounds which were obtained by from the definition of angle measure and compactness of space of directions.

\section{Right-inverse theorem}

\begin{thm}{Theorem}\label{thm:right-inverse}
Suppose $p,a_0,\dots,a_m$ be points in an Alexandrov space $\spc{L}$ such
\[\angk p{a_i}{a_j}>\tfrac\pi2\]
for any $i\ne j$.
Then the map $f\:\spc{L}\to\RR^m$ defined by
\[f\:x\mapsto (\dist{a_1}{x}{},\dots,\dist{a_m}{x}{})\]
has a left inverse defined in a neighborhood of $f(p)$.

Moreover, if $\dim\spc{L}=m$, then $f$ defines a bi-Lipschitz embedding of a small neighborhood of $p$.
\end{thm}

If $\dim\spc{L}=m$, then the restriction of $f$ to a neighbohood provided by the second part of theorem is called \index{distance chart}\emph{distance chart} at $p$.
The following exercise will guide you thru the proof.

\begin{thm}{Exercise}\label{ex:proof-right-inverse}
Suppose $p,a_0,\dots,a_m\in\spc{L}$ and $f\:\spc{L}\to\RR$ are as in \ref{thm:right-inverse}.
Assume $\eps>0$ is sufficiently small.
Given $\bm{y}=(y_1,y_2,\dots,y_m)\in \RR^m$, 
consider the function on $\spc{L}$ defined by
\[f_{\bm{y}}(x)=\min\{\,0, \dist{a_1}{x}{}-y_1,\dots,\dist{a_m}{x}{}-y_m\,\}+\eps\cdot\dist{a_0}{x}{}.\]

\begin{subthm}{ex:proof-right-inverse:grad}
There is $r>0$ such that 
Show that $f_{\bm{y}}$ is $\lambda$-concave in $\oBall(p,r)$ for some $\lambda$ and
\begin{enumerate}[(i)]
\item\label{111} $(\dd_x\distfun_{a_i})(\nabla_x f_{\bm{y}})<-\tfrac{1}{10}\cdot\eps^2$ if $\dist{a_i}{x}{}>y_i$ and
\item\label{222} $(\dd_x\distfun_{a_i})(\nabla_x f_{\bm{y}})>\tfrac{1}{10}\cdot\eps^2$ if 
\[\dist{a_i}{x}{}-y_i=\min_j\{\dist{a_j}{x}{}\z-y_j\}<0.\]
\end{enumerate}
for any $x\in \oBall(p,r)$.

\end{subthm}

\begin{subthm}{ex:proof-right-inverse:alpha}
Let $\alpha_{\bm{y}}$ be $f_{\bm{y}}$-gradient curve that starts at $p$.
Use \ref{SHORT.ex:proof-right-inverse:grad} to show that 
if for some $\bm{y}\in\RR^m$ and $t_0\le\tfrac{r}{2}$ we have
$|\distfun_{\bm{a}}{p}-\bm{y}|
\le
\tfrac{\eps^2}{10}\cdot t_0$, then 
$
\distfun_{\bm{a}}{[\alpha_{\bm{y}}(t_0)]}
= 
\bm{y}$.
\end{subthm}

\begin{subthm}{ex:proof-right-inverse:end}
Set $t_0(\bm{y})=\tfrac{10}{\eps^2}\cdot|\dist{\bm{a}}{p}{}-\bm{y}|$.
Use \ref{lem:fg-dist-est} to show that the map
\[\map\:{\bm{y}}\mapsto \alpha_{\bm{y}}\circ t_0(\bm{y})\]
continuous in $\Omega=\oBall(\dist{\bm{a}}{p}{},\tfrac{\eps^2\cdot r}{20} )\subset\RR^m$
and $f\circ \Phi(\bm{y})=\bm{y}$ for any $\bm{y}\in \Omega$.
This finishes the proof of the first statement in \ref{thm:right-inverse}.
\end{subthm}

\begin{subthm}{ex:proof-right-inverse:dim}
Show that there is $\eps>0$ such that one of the following $m$ inequalities hold
\begin{align*}
\mangle\hinge xy{a_1}&<\tfrac\pi2-\eps,\ \dots,\  \mangle\hinge xy{a_m}<\tfrac\pi2-\eps,
\\
\mangle\hinge yx{a_1}&<\tfrac\pi2-\eps,\ \dots,\ \mangle\hinge yx{a_m}<\tfrac\pi2-\eps
\end{align*}
for any two points $x,y$ in a sufficiently small neighborhood of $p$.
Use it to prove the second statement in \ref{thm:right-inverse}.
\end{subthm}

\end{thm}

\footnote{\red V: I think that since this is used later it should be proved and not left as a reference
A: If we add a solution, then that is OK, is not it? in any case, the idea is more tranparent in the exercise and if needed one can read the solution. But lets do the real solution, not just a hint.}

\section{Other dimensions}

Next we want to show that \textit{all reasonable definitions of dimension give the same result for Alexandrov spaces}.
More precisely, we have the following theorem; compare to \cite[15.16]{alexander-kapovitch-petrunin2024}.
We refer to \cite{hurewicz-wallman} for definitions of \index{Lebesgue coverning dimension}\emph{Lebesgue coverning dimension} \index{$\TopDim$ (topological dimension)}$\TopDim$ and \index{Hausdorff dimension}\emph{Hausdorff dimension} \index{$\HausDim$ (Hausdorff dimension)}$\HausDim$.

\begin{thm}{Theorem}\label{thm:dim=dim}
For any Alexandrov space $\spc{L}$, we have
\[\LinDim \spc{L}=\TopDim \spc{L}=\HausDim \spc{L}.\]
Moreover, the same holds for any open subset in $\spc{L}$.
\end{thm}

\parit{Proof.}
Suppose $\LinDim\spc{L}\ge m$.
The right inverse theorem implies that $\spc{L}$ contains a subset homeomorphic to an open ball in $\EE^m$.
It follows that
\[\TopDim\spc{L}\ge \LinDim\spc{L}.\]

By Szpilrajn's theorem \cite[theorems V 8 and VII 2]{hurewicz-wallman}, 
\[\HausDim\spc{L}\ge\TopDim\spc{L}.\]

Finally, by the Bishop--Gromov inequality (\ref{inq:BG} and \ref{ex:BG}), we get that 
\[\LinDim \spc{L}\ge \HausDim\spc{L}.\]

The second statement ???
\qeds

\footnote{\red A: We use here Bishop--Gromov that is proved in the next lecture... --- switching order does not seem to be a very good option. Maybe we can leave it as it is?}

\section{Comments}

Theorem~\ref{thm:dim=dim}, was ssentially proved by Conrad Plaut \cite{plaut:dimension}.
At that time, it was not known whether
\[\LinDim\spc{L}=\infty\quad \Rightarrow\quad \TopDim\spc{L}=\infty\]
for any $\Alex\kappa$ space $\spc{L}$.
The latter implication was proved by Grigory Perelman and the second author \cite{perelman-petrunin:qg}.

\begin{thm}{Open question}
Let $p$ be a point in an Alexandrov space $\spc{L}$.
Suppose that $0\ne v\in \Lin_p$.
Is it true that the tangent space $\T_p$ splits in the direction of $v$?
\end{thm}

Halbeisen's example \cite{alexander-kapovitch-petrunin2024,halbeisen} shows that compactness of space of directions is essential in the proof that space of directions is $\pi$-geodesic (see \ref{thm:finite-space-of-directions}).

\begin{thm}{Open question}\label{open:Halb-proper}
Let $\spc{L}$ be a proper Alexandrov space.
Is it true that for any $p\in \spc{L}$, the tangent space $\T_p$ is a length space?
\end{thm}
