%%!TEX root = the-splitting.tex
\chapter{Line splitting}\label{chap:splitting}

In this lecture, we prove the line splitting theorem and apply it to study tangent spaces of Alexandrov spaces.

\section{Busemann function}

%??? Вить, если хочешь, можешь поменять везде half-line на ray --- я ни за ни против.

A \index{half-line}\emph{half-line} is a geodesic defined on the real half-line $[0,\infty)$;
that is, a distance-preserving map from $[0,\infty)$ to a metric space.

If $\gamma\:[0,\infty)\to \spc{X}$ is a half-line,
then the limit 
\[\bus_\gamma(x)=\lim_{t\to\infty}\dist{\gamma(t)}{x}{}- t\eqlbl{eq:def:busemann*}\]
is called the \index{Busemann function}\emph{Busemann function} of $\gamma$.
It mimics behavior of the distance function from the ideal point of $\gamma$.

\begin{thm}{Proposition}\label{prop:busemann}
For any half-line $\gamma$ in a metric space $\spc{X}$,
its Busemann function $\bus_\gamma\:\spc{X}\to \RR$ 
is defined.
Moreover, $\bus_\gamma$ is $1$-Lipschitz and $\bus_\gamma (\gamma(t))=-t$ for any $t$.

\end{thm}

\parit{Proof.}
Since $t=\dist{\gamma(0)}{\gamma(t)}{}$, the triangle inequality implies that
\[t\mapsto\dist{\gamma(t)}{x}{}- t\] 
is a nonincreasing function, and
\[\dist{\gamma(t)}{x}{}- t\ge-\dist{\gamma(0)}{x}{}\]
for any $x\in \spc{X}$.
Therefore, the limit in \ref{eq:def:busemann*} is defined,
and it has to be 1-Lipschitz as a limit of 1-Lipschitz functions.
The last statement follows since 
$\dist{\gamma(t)}{\gamma(t_0)}{}\z=t-t_0$ for all large~$t$.
\qeds

\begin{thm}[!]{Exercise}\label{ex:busemann-CBB}
Show that any Busemann function on an $\Alex0$ space is concave.
\end{thm}

\section{Splitting theorem}

A \index{line}\emph{line} is a distance-preserving map
from $\RR$ to a metric space.
In other words, a line is a geodesic defined on the real line $\RR$.

\begin{thm}[!]{Exercise}\label{ex:bus+bus}
Let $\gamma$ be a line in a metric space $\spc{X}$.
Show that for any point $x$ we have
\[\bus_+(x)+\bus_-(x)\ge 0\]
where, $\bus_+$ and $\bus_-$, are the Busemann functions associated with half-lines $\gamma:[0,\infty)\to \spc{A}$ and $\gamma:(-\infty,0]\to \spc{A}$ respectively.
\end{thm}


Let $A$ and $B$ be two subsets in a metric space $\spc{X}$.
We say that $\spc{X}$ is a \index{direct sum}\emph{direct sum} of $A$ and $B$,
or briefly,
\[\spc{X}=A\oplus B\]\index{90@$A\oplus B$ (direct sum)}
if there are retractions $\proj_A\:\spc{X}\to A$
and 
$\proj_B\:\spc{X}\to B$
such that 
\[\dist[2]{x}{y}{}=\dist[2]{\proj_A(x)}{\proj_A(y)}{}+\dist[2]{\proj_B(x)}{\proj_B(y)}{}\]
for any two points $x,y\in \spc{X}$.

\begin{thm}{Exercise}\label{ex:oplus}
Suppose $\spc{X}=A\oplus B$.
Show that
\begin{subthm}{ex:oplus:a}
 $A$ intersects $B$ at a single point, and
\end{subthm}

\begin{subthm}{ex:oplus:b}
both sets $A$ and $B$ are \index{convex set}\emph{convex sets} in $\spc{X}$;
the latter means that any geodesic with the endpoints in $A$ (or $B$) lies in $A$ (respectively $B$).
\end{subthm}

\end{thm}


\begin{thm}{Line splitting theorem}\label{thm:splitting}
Let $\gamma$ be a line in an $\Alex0$ space~$\spc{A}$.
Then 
\[\spc{A}=\spc{A}'\oplus \gamma(\RR)\]
for some subset $\spc{A}'\subset \spc{A}$.
\end{thm}

\begin{thm}{Corollary}\label{cor:splitting}
Any $\Alex0$ space $\spc{A}$ splits isometrically as
\[
\spc{A}=\spc{A}'\oplus H
\]
where $H\subset \spc{A}$ is a subset isometric to a Hilbert space, and $\spc{A}'\subset \spc{A}$ is a convex subset that contains no lines. 
\end{thm}

The following lemma is closely related to the first distance estimate (\ref{thm:dist-est});
it is also a limit case of \ref{prop:gexp}.
The proof follows similar  lines.

\begin{thm}{Lemma}\label{lem:dist-estimate}
Suppose $f\:\spc{A}\to\RR$ is a concave 1-Lipschitz function on an $\Alex0$ space $\spc{A}$.
Consider two $f$-gradient curves $\alpha$ and~$\beta$.
Then for any $t, s\ge 0$ we have
\begin{align*}
&\dist[2]{\alpha(s)}{\beta(t)}{}
\le 
\dist[2]{p}{q}{}+
2\cdot(f(p)-f(q))\cdot(s-t)+ (s-t)^2,
\end{align*}
where $p=\alpha(0)$ and $q=\beta(0)$.
\end{thm}

\parit{Proof.}
Since $f$ is 1-Lipschitz, $|\nabla f|\le1$.
Therefore 
\[f\circ\beta(t)\le f(q)+t\]
for any $t\ge0$.

Set $\ell(t)=\dist{p}{\beta(t)}{}$.
Applying \ref{eq:fist-var-inq+}, we get
\begin{align*}
(\ell^2)^+(t)
&\le 2\cdot \left(f\circ\beta(t)-f(p)\right)\le 
\\
&\le2\cdot\left(f(q)+t-f(p)\right).
\end{align*}
Therefore 
\[\ell^2(t)-\ell^2(0)\le 2\cdot\left(f(q)-f(p)\right)\cdot t + t^2.\]
It proves the needed inequality in case $s=0$.
Combining it with the first distance estimate (\ref{thm:dist-est}), we get the result in case $s\le t$.
The case $s\ge t$ follows by switching the roles of $s$ and $t$.
\qeds


\parit{Proof of \ref{thm:splitting}.} Consider two Busemann functions, $\bus_+$ and $\bus_-$, associated with the  half-lines $\gamma:[0,\infty)\to \spc{A}$ and $\gamma:(-\infty,0]\to \spc{A}$ respectively; that is,
\[
\bus_\pm(x)
\df
\lim_{t\to\infty}\dist{\gamma(\pm t)}{x}{}- t.
\]
According to \ref{ex:busemann-CBB}, 
both $\bus_+$ and $\bus_-$ are concave.

By \ref{ex:bus+bus}, $\bus_+(x)+\bus_-(x)\ge0$ for any $x\in \spc{A}$.
On the other hand, by \ref{comp-kappa}, 
$f\:t\mapsto\distfun_x^2\circ\gamma(t)$
is $2$-concave.
In particular, $f(t)\le t^2+at+b$ for some constants $a,b\in\RR$.  Therefore, for all large $t$
\[
\dist{\gamma( t)}{x}{}+\dist{\gamma(- t)}{x}{}- 2\cdot t
\le \sqrt{ t^2+at+b}+\sqrt{ t^2-at+b}-2\cdot t
\]

Passing to the limit as $t\to\infty$, we get that  $\bus_+(x)+\bus_-(x)\le 0$.
Hence
\[
\bus_+(x)+\bus_-(x)= 0
\]
for any $x\in \spc{A}$.
In particular, the functions $\bus_+$ and $\bus_-$ are \index{affine function}\emph{affine};
that is, they are convex and concave at the same time.

For any $x$,
\begin{align*}
|\nabla_x \bus_\pm|
&=\sup\set{\dd_x\bus_\pm(\xi)}{\xi\in\Sigma_x}=
\\
&=\sup\set{-\dd_x\bus_\mp(\xi)}{\xi\in\Sigma_x}\equiv
\\
&\equiv1.
\end{align*}

A curve $\alpha$ is a $\bus_\pm$-gradient curve
if and only if $\alpha$ is a geodesic such that $(\bus_\pm\circ\alpha)^+=1$.
Indeed, if $\alpha$ is a geodesic, then $(\bus_\pm\circ\alpha)^+\le 1$ and the equality holds only if $\nabla_\alpha\bus_\pm=\alpha^+$.
Now suppose $\nabla_\alpha\bus_\pm\z=\alpha^+$.
Then $|\alpha^+|\le 1$ and $(\bus_\pm\circ\alpha)^+=1$; therefore 
\begin{align*}
|t_0-t_1|&\ge \dist{\alpha(t_0)}{\alpha(t_1)}{}\ge
\\
&\ge|\bus_\pm\circ\alpha(t_0)-\bus_\pm\circ\alpha(t_1)|=
\\
&=|t_0-t_1|.
\end{align*}

It follows that for any $t>0$, the $\bus_\pm$-gradient flows commute;
that is, 
\[\GF_{\bus_+}^t\circ\GF_{\bus_-}^t=\id_\spc{A}.\]
Setting
\[\GF^t=\left[\begin{matrix}
\GF_{\bus_+}^t&\hbox{if}\ t\ge0\\
\GF_{\bus_-}^{-t}&\hbox{if}\ t\le0
               \end{matrix}\right.\]
defines an $\RR$-action on $\spc{A}$.

Consider the level set $\spc{A}'=\bus_+^{-1}(0)=\bus_-^{-1}(0)$;
it is a closed convex subset of $\spc{A}$, and therefore forms an Alexandrov space.
Consider the map $h\:\spc{A}'\times \RR\to \spc{A}$ defined by $h\:(x,t)\mapsto \GF^t(x)$.
Note that $h$ is onto.
Applying \ref{lem:dist-estimate} for $\GF_{\bus_+}^t$ and $\GF_{\bus_-}^t$ shows that $h$ is distance nonexpanding and noncontracting at the same time; that is, $h$ is an isometry.
\qeds

\begin{thm}{Exercise}\label{ex:cone-CBB}
Suppose $\spc{X}$ is a complete geodesic space.
Show that $\Cone\spc{X}$ is $\Alex0$ if and only if $\spc{X}$ is $\Alex1$ and $\diam\spc{X}\le \pi$.
\end{thm}

Recall that according to our definition any circle or closed real interval is $\Alex1$.
Therefore, the condition $\diam\spc{X}\le \pi$ is necessary.
Nevertheless, according to \ref{ex:RisCBB(1)}, most of $\Alex1$ spaces have diameter at most $\pi$.

\section{Anti-sum}

The following lemma is a corollary of \ref{ex:convergence-grad}.
It will be used to prove basic properties of tangent spaces.


\begin{thm}{Anti-sum lemma}\label{lem:minus-sum} 
Let $p$ be a point in an Alexandrov space $\spc{A}$.
Given two vectors $u,v\in \T_p$, there is a unique vector $w\in \T_p$ such that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle \ge 0\]
for any $x\in \T_p$, and
\[\langle u,w\rangle +\langle v,w\rangle +\langle w,w\rangle =0.\]

\end{thm}

\begin{thm}[!]{Exercise}\label{ex:|antisum|}
Suppose $u,v, w\in \T_p$ are as in \ref{lem:minus-sum}.
Show that 
\[|w|^2\le |u|^2+|v|^2+2\cdot\langle u,v\rangle.\]

\end{thm}

If $\T_p$ were $\Alex0$, then the lemma would follow from the existence  of the gradient, applied to the function $\T_p\to \RR$ defined by $x\mapsto -(\langle u,x\rangle +\langle v,x\rangle )$, which is concave by \ref{ex:busemann-CBB}.
As you will see, a revision of this idea works in the general case, but it cannot work as is since $\T_p$ might fail to be geodesic; see Halbeisen's example \cite[13.6]{alexander-kapovitch-petrunin2024}.

Applying the above lemma for $u=v$, we have the following statement.

\begin{thm}{Existence of polar vector}\label{cor:polar}
Let $\spc{A}$ be an Alexandrov space 
and $p\in \spc{A}$. 
Given a vector $u\in \T_p$,  there is a unique vector $u^*\in\T_p$ such that $\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0$ and
$u^*$ is \index{polar vectors}\emph{polar} to $u$;
that is,
\[\langle u^*,x\rangle +\langle u,x\rangle \ge 0\]
for any $x\in \T_p$.
\end{thm}

\parit{Proof of \ref{lem:minus-sum}.}
By \ref{ex:d(distfun):==}, we can choose two sequences of points $a_n,b_n$ such that 
\[
\dd_p\distfun_{a_n}(w)=-\langle\dir{p}{a_n},w\rangle
\quad\text{and}\quad
\dd_p\distfun_{b_n}(w)=-\langle\dir{p}{b_n},w\rangle
\]
for any $w\in\T_p$.
Furthermore, we can assume that $\dir{p}{a_n}\to u/|u|$ and $\dir{p}{b_n}\to v/|v|$ as $n\to \infty$

Consider a sequence of functions 
\[f_n=|u|\cdot\distfun_{a_n}+|v|\cdot\distfun_{b_n}.\]
Note that 
\[(\dd_pf_n)(x)=-|u|\cdot\langle \dir{p}{a_n},x\rangle -|v|\cdot\langle \dir{p}{b_n},x\rangle .\]
Thus we have the following uniform convergence for $x\in\Sigma_p$:
\[(\dd_pf_n)(x)\rightrightarrows-\langle u,x\rangle -\langle v,x\rangle \]
as $n\to\infty$.
According to \ref{ex:convergence-grad}, 
the sequence $\nabla_pf_n$ converges.
Let 
\[w=\lim_{n\to\infty}\nabla_pf_n.\]
By the definition of gradient,
\begin{align*}
\langle w,w\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,\nabla_pf_n\rangle =
&&&%right side
\langle w,x\rangle &=\lim_{n\to\infty}\langle \nabla_pf_n,x\rangle \ge
\\%second line
&=\lim_{n\to\infty}(\dd_p f_n)(\nabla_p f_n)
=
&&&%second line right side
&\ge
\lim_{n\to\infty}(\dd_pf_n)(x)
=
\\%line 3
&=-\langle u,w\rangle -\langle v,w\rangle ,
&&&%line 3 right side
&=-\langle u,x\rangle -\langle v,x\rangle .
\end{align*}

The proof of uniqueness is very similar to the proof of uniqueness of gradients and is left to the reader.
\qedsf

\section{Linear subspace}

\begin{thm}{Definition}\label{def:opp+Lin}
Let $\spc{A}$ be an Alexandrov space, $p\in \spc{A}$ and $u,v\z\in\T_p$.
We say that vectors $u$ and $v$ are \index{opposite vectors}\emph{opposite}\label{def:opposite:page} to each other, (briefly, $u+v=0$) if $|u|=|v|=0$ or $\mangle(u,v)=\pi$ and $|u|=|v|$.

The subcone
\[\Lin_p=\set{v\in\T_p}{\exists\ w\in\T_p\quad \text{such that}\quad w+v=0}\]
will be called the \index{linear subspace}\emph{linear subspace} of $\T_p$.
\end{thm}

Soon we will introduce a natural linear structure on $\Lin_p$.

\begin{thm}{Proposition}\label{prop:opposite}
Let $p$ be a point in an Alexandrov space.
Given two vectors $u,v\in\T_p$, the following statements are equivalent:
\begin{subthm}{opposite} $u+v=0$;
\end{subthm}
\begin{subthm}{<x,u>} $\langle u,x\rangle +\langle v,x\rangle =0$ for any $x\in\T_p$;
\end{subthm}
\begin{subthm}{<xi,u>} $\langle u,\xi\rangle +\langle v,\xi\rangle =0$ for any $\xi\in\Sigma_p$.
\end{subthm}
\end{thm}

\parit{Proof.}
The equivalence  \ref{SHORT.<x,u>}$\Leftrightarrow$\ref{SHORT.<xi,u>} is trivial.

The condition $u+v=0$ is equivalent to 
$\langle u,u\rangle =-\langle u,v\rangle =\langle v,v\rangle$;
thus,
\ref{SHORT.<x,u>}$\Rightarrow$\ref{SHORT.opposite}.

Suppose  \ref{SHORT.opposite} holds.
Recall that $\T_p$ has nonnegative curvature.
The hinges $\hinge 0ux$ and $\hinge 0vx$ are adjacent.
By \ref{ex:adjacent-CBB}, $\mangle\hinge 0ux+\mangle\hinge 0vx=\pi$;
hence \ref{SHORT.opposite}$\Rightarrow$\ref{SHORT.<x,u>}.
\qeds

\begin{thm}[!]{Exercise}\label{prop:two-opp}
Let $u$, $v$, and $w$ be tangent vectors at a point of an Alexandrov space.
Assume $u+v=0$ and $u+ w=0$.
Show that $v=w$.
\end{thm}

Let $u\in \Lin_p$; that is, $u+v=0$ for some $v\in\T_p$.
Given $s<0$, let 
\[s\cdot u\df (-s)\cdot v.\]
So we can multiply any vector in $\Lin_p$ by any real number (positive and negative).
By \ref{prop:two-opp}, this multiplication is uniquely defined.
By \ref{prop:opposite}, we have identity
\[\langle -v,x\rangle=-\langle v,x\rangle.\]


\begin{thm}[!]{Exercise}\label{ex:3<,>=0}
Suppose $u$, $v$, and $w$ are as in \ref{lem:minus-sum}.
Show that
\[\langle u,x\rangle +\langle v,x\rangle +\langle w,x\rangle = 0\]
for any $x\in \Lin_p$.
\end{thm}

\begin{thm}[!]{Exercise}\label{ex:-u}
Let $\spc{A}$ be an Alexandrov space,
$p\in \spc{A}$ and $u\in \T_p$.
Suppose $u^*\in \T_p$ is from \ref{cor:polar};
that is, 
\[\langle u^*,u^*\rangle +\langle u,u^*\rangle = 0
\quad\text{and}\quad
\langle u^*,x\rangle +\langle u,x\rangle \ge 0
\]
for any $x\in \T_p$.
Show that $u=-u^*$ if and only if $|u|=|u^*|$.
\end{thm}

\begin{thm}{Theorem}\label{thm:lin-subcone}
Let $p$ be a point in an Alexandrov space. 
Then $\Lin_p$ is isometric to a Hilbert space.
\end{thm}

\parit{Proof.}
$\Lin_p$ is a closed subset of $\T_p$;
in particular, it is complete.

If any two vectors in $\Lin_p$ can be connected by a geodesic in $\Lin_p$,
then the statement follows from the splitting theorem (\ref{thm:splitting}).
By Menger's lemma (\ref{lem:mid>geod}), it is sufficient to show that for any pair $x,y\in\Lin_p$
has a midpoint $w\in \Lin_p$.

Choose $w\in \T_p$ to be the anti-sum of $u=-\tfrac{1}{2}\cdot x$ and $v=-\tfrac{1}{2}\cdot y$;
see \ref{lem:minus-sum}.
By \ref{ex:|antisum|} and \ref{ex:3<,>=0},
\begin{align*}
|w|^2&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,x\rangle&= \tfrac12\cdot|x|^2+\tfrac12\cdot\langle x,y\rangle,
\\
\langle w,y\rangle&= \tfrac12\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle.
\end{align*}
It follows that 
\begin{align*}
|x-w|^2
&= |x|^2+|w|^2-2\cdot\langle w,x\rangle\le
\\
&\le \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2-\tfrac12\cdot\langle x,y\rangle=
\\
&=\tfrac14\cdot|x-y|^2.
\end{align*}
That is, $|x-w|\le \tfrac12\cdot|x-y|$.
Similarly, we get $|y-w|\le \tfrac12\cdot|x-y|$.
Therefore $w$ is a midpoint of $x$ and $y$.
In addition, we get the equality 
\[|w|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle.\]

It remains to show that $w\in\Lin_p$.
Let $w^*$ be the polar vector provided by \ref{cor:polar}.
Note that 
\[|w^*|\le |w|,
\quad
\langle w^*,x\rangle+\langle w,x\rangle=0,
\quad\text{and}\quad
\langle w^*,y\rangle+\langle w,y\rangle=0.
\]
The same calculation as above shows that $w^*$ is a midpoint of $-x$ and $-y$ and 
\[|w^*|^2= \tfrac14\cdot |x|^2+\tfrac14\cdot|y|^2+\tfrac12\cdot\langle x,y\rangle=|w|^2.\]
By \ref{ex:-u}, $w=-w^*$;
hence $w\in\Lin_p$.
\qeds

\begin{thm}{Lemma}\label{ex:grad-dist:G-delta}
Given a point $p$ in an Alexandrov space $\spc{A}$,
let $f\z=\distfun_p$, and let $S$ be the subset of points $x\in\spc{A}$ such that $|\nabla_xf|=1$.
Then $S$ is a dense G-delta set.

\end{thm}

\parit{Proof.}
Given a positive integer $n$, consider the set
\[S_n=\set{x\in\spc{A}}{|\nabla_xf|>1-\tfrac1n}.\]
By \ref{ex:semicontinuous-grad:>s}, $S_n$ is open.

Choose a point $q\ne p$.
Observe that $|\nabla_xf|=1$ for any point $x\in\left]pq\right[$.
It follows that $S_n$ is dense in $\spc{A}$.
Since $S=\bigcap_nS_n$, the lemma follows from the Baire category theorem.
\qeds


\begin{thm}[!]{Exercise}\label{ex:grad-dist}
Let $p$, $f$, and $S$ be as in \ref{ex:grad-dist:G-delta}.

\begin{subthm}{ex:grad-dist:lin}
Show that 
\[\nabla_xf+\dir xp=0\]
for any 
$x\in S$;
in particular, $\dir xp\in \Lin_x$.
\end{subthm}

\begin{subthm}{ex:grad-dist:|grad|=1}
Show that if $|\nabla_xf|=1$, then $\dd_xf(w)= \langle\nabla_xf,w\rangle$ for any $w\in \T_x$.
\end{subthm}

\begin{subthm}{ex:grad-dist:geod}
Show that for any $x\in S$ there is a unique geodesic $[px]$.
\end{subthm}

\end{thm}

This exercise implies the following.

\begin{thm}{Corollary}\label{cor:euclid-subcone}
Given a countable set of points $X$ in an Alexandrov space $\spc{A}$
there is a G-delta dense set $S\subset\spc{A}$
such that 
$\dir sx\in \Lin_s$
for any $s\in S$ and $x\in X$.
\end{thm}

\section{Remarks}

The history of the splitting theorem starts with Stefan Cohn-Vossen \cite{cohn-vossen_line},
who proved it in the $2$-dimensional case.
For Riemannian manifolds of higher dimensions,
it was proved by Victor Toponogov \cite{toponogov-globalization+splitting}.
Then it was generalized by Anatoliy Milka \cite{milka-line}
to Alexandrov spaces;
it was the first result about Alexandrov spaces of dimension higher than 2.
Nearly the same proof is used in \cite[1.5]{burago-burago-ivanov}.
Generalizations to Riemannian manifolds with nonnegative Ricci curvature were obtained by Jeff Cheeger and Detlef Gromoll \cite{cheeger-gromoll-split}.
This was further generalized by Jeff Cheeger and Toby Colding for the limits of Riemannian manifolds with almost nonnegative Ricci curvature \cite{cheeger-colding-alm-rigidity}.
Nicola Gigli generalized it further to the so-called {}\emph{RCD spaces} (spaces with synthetically defined Ricci-curvature bound) \cite{gigli2013splitting, gigli-splitting-overview}.
Jost-Hinrich Eschenburg obtained an analogous result for Lorentzian manifolds \cite{eshenburg-split}.

The presented proof is close in spirit to the proof given by Cheeger and Gromoll \cite{cheeger-gromoll-split};
it is taken from our book \cite{alexander-kapovitch-petrunin2024}.

\begin{thm}{Open question}
Let $p$ be a point in an Alexandrov space $\spc{A}$.
Suppose that $0\ne v\in \Lin_p$.
Is it true that the tangent space $\T_p$ splits in the direction of $v$?
\end{thm}

Halbeisen's example \cite{alexander-kapovitch-petrunin2024,halbeisen} shows that compactness of space of directions is essential in the proof that space of directions is $\pi$-geodesic (see \ref{thm:finite-space-of-directions}).

\begin{thm}{Open question}\label{open:Halb-proper}
Let $\spc{A}$ be a proper Alexandrov space.
Is it true that for any $p\in \spc{A}$, the tangent space $\T_p$ is a length space?
\end{thm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Dimension and volume}\label{chap:dim}

\section{Linear dimension}

Let $\spc{A}$ be an Alexandrov space.
We define its \index{linear dimension}\emph{linear dimension} \index{LinDim@$\LinDim$}$\LinDim \spc{A}$ as the least upper bound of integers $m$ such that
the Euclidean space $\EE^m$ is isometric to a subspace of the tangent space $\T_p\spc{A}$ at \textit{some} point $p\in \spc{A}$.

If not stated otherwise, dimension means linear dimension.
In Section~\ref{sec:all-dim}, we will show that linear dimension of Alexandrov space coincides with all reasonable dimensions;
after that, we will use \index{dim@$\dim$}$\dim\spc{A}$ for $\LinDim\spc{A}$.

\begin{thm}{(\textit{n}+1)-comparison}\label{thm:n+1}
Let $\spc{A}$ be an $\Alex0$ space.
Then for any finite set of points $p,x_1,\dots,x_n\in \spc{A}$, there exist a model configuration
$\tilde p,\tilde x_1,\dots,\tilde x_n\in \EE^m$ for some $m$ such that
\[|\tilde p-\tilde x_i|_{\EE^m}=| p- x_i|_{\spc{A}}
\quad\text{and}\quad
|\tilde x_i-\tilde x_j|_{\EE^m}\ge |x_i- x_j|_{\spc{A}}\]
for any $i$ and $j$.
Moreover, we can assume that $m\le \LinDim\spc{A}$.

If $\spc{A}$ is an $\Alex{\pm1}$ space, then the same holds if we exchange $\EE^m$ to $\SSS^m$ or $\HH^m$, respectively; in the $\Alex{1}$ case one have to assume in addition that $\diam \spc{A}\le \pi$.
\end{thm}

\parit{Proof.}
By \ref{cor:euclid-subcone}, we can choose a point $p'$ arbitrarily close to $p$ so that 
$\Lin_{p'}\ni \dir{p'}{x_i}$ for any $i$.
Let us identify $\EE^m$ with a subspace of $\Lin_{p'}$ spanned by $\dir{p'}{x_1},\dots,\dir{p'}{x_n}$.
Note that $m\le \LinDim\spc{A}$.

Set $\tilde p'=0\in \EE^m$ and $\tilde x_i=\dist{p'}{x_i}{}\cdot\dir{p'}{x_i}\in \EE^m$ for every $i$.
Note that 
\[|\tilde p'-\tilde x_i|_{\EE^m}=| p'- x_i|_{\spc{A}}\]
for every $i$.
Applying the comparison $\mangle\hinge {p'}{x_i}{x_j}\ge \angk {p'}{x_i}{x_j}$, we get
\[|\tilde x_i-\tilde x_j|_{\EE^m}\ge |x_i- x_j|_{\spc{A}}\]
for all $i$ and $j$.
Passing to a limit configuration as $p'\to p$ we get the result.

If $\spc{A}$ is an $\Alex{-1}$ space, then the same argument gives
$\tilde p,\tilde x_1,\z\dots,\tilde x_n\in \EE^m$ such that
\[|\tilde p-\tilde x_i|_{\EE^m}=| p- x_i|_{\spc{A}}
\quad\text{and}\quad
\side\hinge{\tilde p}{\tilde x_i}{\tilde x_j}_{\HH^2}\ge |x_i- x_j|_{\spc{A}}.\]
It remains to observe that $\EE^m$ with the metric defined by
$\dist{\tilde v}{\tilde w}{}\z\df \side\hinge{\tilde p}{\tilde v}{\tilde w}_{\HH^2}$
is isometric to $\HH^m$.
The $\Alex{1}$ case is analogous.
\qeds

\begin{thm}[!]{Exercise}\label{ex:dim-max}
Let $\spc{A}$ be an $\Alex0$ space.
Suppose that $\LinDim \spc{A}\z= m<\infty$ and the Euclidean space $\EE^m$ is isometric to a subspace of the tangent space $\T_p\spc{A}$ at \textit{some} point $p\in \spc{A}$.
Show that $\T_p\spc{A}\iso \EE^m$.
\end{thm}


\begin{thm}[!]{Exercise}\label{ex:dim=1}
Show that a 1-dimensional Alexandrov space is homeomorphic to a 1-dimensional manifold, possibly with nonempty boundary.
\end{thm}


\begin{thm}{Exercise}\label{ex:resporka}
Let $\spc{A}$ be an $\Alex0$ space.
Show that $\LinDim \spc{A}\z\ge m$ if and only if there are $m+2$ points $p$, $a_0,\z\dots, a_{m}\in \spc{A}$
such that $\angk p{a_i}{a_j}>\tfrac\pi2$ for any pair $i\ne j$.
\end{thm}

\section{Space of directions}

Recall that a metric space $\spc{X}$ is \index{geodesic space@$\ell$-geodesic space}\emph{$\ell$-geodesic}
if any two points $x,y\in\spc{X}$ such that $\dist{x}{y}{}<\ell$ can be connected by a geodesic.

\begin{thm}{Theorem}\label{thm:finite-space-of-directions}
Let $\spc{A}$ be a finite-dimensional Alexandrov space.
Then for any point $p\in \spc{A}$, its space of directions $\Sigma_p$ is compact and $\pi$-geodesic.
\end{thm}

By \ref{ex:GHto-tangent}, this theorem implies the following.

\begin{thm}{Corollary}\label{ex:GHto-tangent-finite-dim}
Let $p$ be a point in a finite dimensional Alexandrov space $\spc{A}$,
and let $\lambda_n\to\infty$.
Then there is a pointed Gromov--Hausdorff convergence $(\lambda_n\cdot \spc{A},p)\z\to (\T_p,0)$.
%Moreover, for any geodesic $\gamma$ that starts at $p$, we have
%\[\iota_n\circ\gamma(t/\lambda_n)\to t\cdot \gamma^+(0),\]
%where $\iota_n$ sends a point in $\spc{A}$ to the corresponding point in $\lambda_n\cdot\spc{A}$.
\end{thm}

\parit{Proof of \ref{thm:finite-space-of-directions}.}
Choose $\eps>0$; suppose $\spc{A}$ is $m$-dimensional.
Assume $\pack_\eps \Sigma_p\ge n$;
that is, we can choose $n$ directions $\xi_1,\dots, \xi_n\in \Sigma_p$ such that $\mangle(\xi_i,\xi_j)\z>\eps$ for any $i\ne j$.
Without loss of generality, we may assume that each direction is geodesic;
that is, there is a point $x_i\in \spc{A}$ such that $\xi_i=\dir p{x_i}$.

Choose $y_i\in [px_i]$ such that $\dist{p}{y_i}{}=r$ for each $i$ and small fixed $r>0$.
Since $r$ is small, we can assume that $\angk p{y_i}{y_j}>\eps$ for $i\ne j$.
By \ref{cor:euclid-subcone}, we can choose $p'$ arbitrarily close to $p$ such that $\dir{p'}{y_i}\in \Lin_{p'}$ for any $i$;
in particular, all directions $\dir{p'}{y_i}$ lie in a unit sphere of dimension at most $m-1$.
Since  $\dist{p'}{p}{}$ is small, $\angk {p'}{y_i}{y_j}>\eps$ if $i\ne j$.
By comparison, 
\[\mangle \hinge{p'}{y_i}{y_j}>\eps.\]
Therefore, $\pack_\eps \Sigma_p\le \pack_\eps\SSS^{m-1}$.

Since $\SSS^{m-1}$ is compact, $\pack_\eps\SSS^{m-1}<\infty$ for any $\eps>0$.
By the definition, the space of directions $\Sigma_p$ is complete. 
Applying \ref{ex:pack-net}, we get that  $\Sigma_p$ is compact.

It remains to prove the following claim.

\begin{clm}{}
If $\Sigma_p$ is compact, then it is $\pi$-geodesic
\end{clm}

Choose two geodesic directions $\xi=\dir px$ and $\zeta=\dir py$;
let 
\[\alpha\z=\tfrac12\cdot \mangle \hinge pxy=\tfrac12\cdot \dist{\xi}{\zeta}{\Sigma_p}.\]
Assume $\alpha<\tfrac\pi2$.

It is sufficient to construct an \index{almost midpoint}\emph{almost midpoint} $\mu\z=\dir pz$ of $\xi$ and $\zeta$ in $\Sigma_p$;
that is, we need to show that for any $\eps>0$ there is a geodesic $[pz]$ such that
\[\mangle\hinge pxz\le \alpha+\eps
\quad\text{and}\quad
\mangle\hinge pyz\le \alpha+\eps.\]
Indeed, once this is done, the compactness of $\Sigma_p$ can be used to get an actual midpoint for any two directions in $\Sigma_p$, and Menger's lemma (\ref{lem:mid>geod}) finishes the proof.

Choose a sequence of small positive numbers $r_n\to0$.
Consider sequences $x_n\z\in [px]$ and $y_n\z\in [py]$ such that $\dist{p}{x_n}{}=\dist{p}{y_n}{}=r_n$.
Let $m_n$ be a midpoint of $[x_n\,y_n]$.
Since $\alpha<\tfrac\pi2$, $m_n\ne p$.

Since $\Sigma_p$ is compact, we can pass to a subsequence of $r_n$ such that
$\dir{p}{m_n}$ converges;
denote the limit by $\mu$.
Choose a geodesic $[pz]$ that runs at a small angle to $\mu$.
It remains to show that $\dir pz$ is the needed almost midpoint.

Evidently, $\angk p{x_n}{m_n}=\angk p{y_n}{m_n}$.
By \ref{ex:alex-lemma-cat}, we have
\[\angk p{x_n}{m_n}+\angk p{y_n}{m_n}\le \angk p{x_n}{y_n}.\]

Choose points $z_n\in [pz]$ such that $\dist{p}{z_n}{}=\dist{p}{m_n}{}$ for all large~$n$.
By construction, for all large $n$, we have $\mangle\hinge pz{m_n}\approx0$  with arbitrary small given error.
By comparison, the value $\frac{\dist{z_n}{m_n}{}}{\dist{p}{z_n}{}}$ can be assumed to be arbitrarily small for all large $n$.
Applying this observation and the definition of angle measure, we also get that the following approximations
\begin{align*}
\angk p{x_n}{y_n}&\approx \mangle\hinge p{x_n}{y_n},
\\
\angk p{x_n}{m_n}&\approx\angk p{x_n}{z_n}\approx\mangle\hinge p{x_n}{z_n},
\\
\angk p{m_n}{y_n}&\approx\angk p{z_n}{y_n}\approx\mangle\hinge p{z_n}{y_n},
\end{align*}
hold with arbitrary given error and all large $n$.
It follows that $\dir pz$ is an almost midpoint of $\dir px$ and $\dir py$, as required.
\qeds

\parit{Remark.}
In the above proof, the angles $\mangle\hinge pxz$ and $\mangle\hinge pyz$ have lower bounds by
the comparison, but we needed upper bounds.
These were extracted from the definition of angle measure and the compactness of the space of directions.
Halbeisen's example \cite[13.6]{alexander-kapovitch-petrunin2024} shows that it cannot be done without the compactness condition.

\section{Right-inverse theorem}

\begin{thm}{Right-inverse theorem}\label{thm:right-inverse}
Suppose $p,a_0,\dots,a_m$ are points in an Alexandrov space $\spc{A}$ such that
\[\angk p{a_i}{a_j}>\tfrac\pi2\]
for any $i\ne j$.
Then the map $f\:\spc{A}\to\RR^m$ defined by
\[f\:x\mapsto (\dist{a_1}{x}{},\dots,\dist{a_m}{x}{})\]
has a  continuous right inverse defined in a neighborhood of $f(p)$.
\end{thm}

In the proof we construct a local right inverse $\map$ of $f$ around $f(p)$.
The construction uses gradient flow for a suitably chosen family of functions.
The proof can be extracted from the following exercise;
more details are given in the hints.

\begin{thm}[!]{Exercise}\label{ex:proof-right-inverse}
Suppose $p,a_0,\dots,a_m\in\spc{A}$ and $f\:\spc{A}\to\RR$ are as in \ref{thm:right-inverse}.
Assume $\eps>0$ is sufficiently small.
Given $\bm{y}\z=(y_1,\z\dots,y_m)\in \RR^m$, 
consider the function on $\spc{A}$ defined by
\[f_{\bm{y}}(x)\df\min\{\,0, \dist{a_1}{x}{}-y_1,\dots,\dist{a_m}{x}{}-y_m\,\}+\eps\cdot\dist{a_0}{x}{}.\]


\begin{subthm}{ex:proof-right-inverse:grad}
Show that for some fixed $r>0$ and $\lambda$, the function $f_{\bm{y}}$ is $\lambda$-concave in $\oBall(p,r)$,
\begin{enumerate}[(i)]
\item\label{111} $(\dd_x\distfun_{a_i})(\nabla_x f_{\bm{y}})<-\eps^2$ if $\dist{a_i}{x}{}>y_i$ and
\item\label{222} $(\dd_x\distfun_{a_i})(\nabla_x f_{\bm{y}})>\eps^2$ if 
\[\dist{a_i}{x}{}-y_i=\min_j\{\dist{a_j}{x}{}\z-y_j\}<0.\]
\end{enumerate}
at any $x\in \oBall(p,r)$.

\end{subthm}

\begin{subthm}{ex:proof-right-inverse:alpha}
Let $\alpha_{\bm{y}}$ be $f_{\bm{y}}$-gradient curve that starts at $p$.
Use \ref{SHORT.ex:proof-right-inverse:grad} to show that 
\[
\distfun_{\bm{a}}{[\alpha_{\bm{y}}(t_0)]}
= 
\bm{y}\]
if 
$\tfrac1{\eps^2}\cdot|\distfun_{\bm{a}}{p}-\bm{y}|
\le
t_0
\le
\tfrac{r}{2}$.

\end{subthm}

\begin{subthm}{ex:proof-right-inverse:end}
Let $t_0(\bm{y})=\tfrac{1}{\eps^2}\cdot\bigl|\dist{\bm{a}}{p}{}-\bm{y}\bigr|$.
Use \ref{lem:fg-dist-est} to show that the map
\[\map\:{\bm{y}}\mapsto \alpha_{\bm{y}}\circ t_0(\bm{y})\]
continuous (in fact H\"older) in $\Omega=\oBall(\dist{\bm{a}}{p}{},\tfrac{\eps^2}{2}\cdot r )\subset\RR^m$
and $f\circ \Phi(\bm{y})=\bm{y}$ for any $\bm{y}\in \Omega$.
(This finishes the proof of \ref{thm:right-inverse}.)
\end{subthm}

\end{thm}

\begin{thm}{Corollary}\label{cor:tan-g-delta}
Let $\spc{A}$ be an Alexandrov space, and let $m$ be an integer.
If $m\le \LinDim\spc{A}$ then
\[\dim\Lin_s\z\ge m\]
for any point $s$ in a dense G-delta subset of points in $\spc{A}$.

Moreover if $m= \LinDim\spc{A}$, then $\T_s\spc{A}\iso \EE^m$ for points $s$ in a dense G-delta set of points in $\spc{A}$.
\end{thm}

\parit{Proof.}
Applying rescaling, we can assume that $\spc{A}$ is $\Alex{-1}$.

By the right-inverse theorem and \ref{ex:resporka} there is a ball $B=\cBall[p,r]_{\spc{A}}$ and $\Const>0$ such that
\[\pack_\eps B\ge \frac{\Const}{\eps^m}\]
for all small $\eps>0$.

In particular, given a radius $R$ we can choose $\eps>0$ and an integer $N$ such that
\[\pack_\eps \cBall(0,R+r)_{\HH^{m-1}}< N\le \pack_\eps B.\]

Applying \ref{cor:euclid-subcone} to an $\eps$-packing $x_1,\dots,x_N$ in $B$, we get that \[\dim\Lin_s\z\ge m\]
for any point $s$ in a dense G-delta subset of $\oBall(p,R)$.
Since $R>0$ is arbitrary, the first statement follows.

To prove the last statement, apply \ref{ex:dim-max}.
\qeds

\section{Distance chart}

\begin{thm}{Theorem}\label{thm:dist-chart}
Suppose $p,a_0,\dots,a_m$ are points in an $m$-dimensional Alexandrov space $\spc{A}$ such that
\[\angk p{a_i}{a_j}>\tfrac\pi2\]
for any $i\ne j$.
Then the map $f\:\spc{A}\to\RR^m$ defined by
\[f\:x\mapsto (\dist{a_1}{x}{},\dots,\dist{a_m}{x}{})\]
gives a bi-Lipschitz embedding of a neighborhood $\Omega$ of $p$;
the restriction $f|_\Omega$ is called a  \emph{distance chart} at $p$.
\end{thm}

The following exercise guides you to prove the theorem.

\begin{thm}[!]{Exercise}\label{ex:proof-dist-chart}
Suppose $p,a_0,\dots,a_m\in\spc{A}$ and $f\:\spc{A}\to\RR$ are as in \ref{thm:right-inverse}.
Show that there is $\eps>0$ such that one of the inequalities holds in each of the following two strings of $m$  inequalities
\begin{align*}
\mangle\hinge xy{a_1}&<\tfrac\pi2-\eps,\ \dots,\  \mangle\hinge xy{a_m}<\tfrac\pi2-\eps;
\\
\mangle\hinge yx{a_1}&<\tfrac\pi2-\eps,\ \dots,\ \mangle\hinge yx{a_m}<\tfrac\pi2-\eps
\end{align*}
for any two points $x,y$ in a sufficiently small neighborhood of $p$.

Use this together with the right-inverse theorem (\ref{thm:right-inverse}) to prove \ref{thm:dist-chart}.
\end{thm}


\section{Volume}

Fix a positive integer $m$.
The $m$-dimensional Hausdorff measure of a Borel set $B$ in a metric space will be called its \index{volume}\emph{$m$-volume}; it will be denoted by $\vol_m B$.
We assume that the Hausdorff measure is calibrated so that the unit cube in $\EE^m$ has unit volume.

This definition will be applied mostly to subsets in $m$-dimensional Alexandrov spaces.
In this case, we may write $\vol B$ instead of $\vol_m B$.

\begin{thm}{Bishop--Gromov inequality}\label{inq:BG}
Let $\spc{A}$ be an $\Alex0$ space.

\begin{subthm}{inq:BG:a}
Then
\[\vol_k \oBall(p,r)_{\spc{A}}\le \vol_k \oBall(0,r)_{\T_p\spc{A}}\]
for any integer $k\ge 0$, any point $p\in \spc{A}$ and any radius $r>0$.
\end{subthm}

\smallskip

\noindent Further, suppose $\LinDim \spc{A}=m<\infty$.

\smallskip

\begin{subthm}{inq:BG:b}
Then for any point $p\in \spc{A}$ and any radius $r>0$ we have
\[\vol_m \oBall(p,r)\le \omega_m\cdot r^m,\]
where $\omega_m$ denotes the volume of the unit ball in $\EE^m$.
\end{subthm}

\begin{subthm}{inq:BG:c}
Moreover, the function
\[r\mapsto \frac{\vol_m B(p,r)}{r^m}\]
is nonincreasing.
\end{subthm}

\end{thm}

\parit{Proof.}
Given $x\in\spc{A}$, choose a geodesic path $\gamma_x$ from $p$ to $x$.
Recall that $\log_p\:\spc{A}\to \T_p$ can be defined by $\log_p\:x\mapsto \gamma_x^+(0)$.
By comparison, $\log_p$ is distance-noncontracting.
Note that $\log_p(\oBall(p,r)_{\spc{A}})\subset \oBall(0,r)_{\T_p}$;
this proves part \ref{SHORT.inq:BG:a}.

\begin{wrapfigure}{r}{44 mm}
\vskip-4mm
\centering
\includegraphics{mppics/pic-803}
\vskip1mm
\end{wrapfigure}

If $\T_p\iso \EE^k$ for some $k\le m$, then \ref{SHORT.inq:BG:a} implies \ref{SHORT.inq:BG:b}.
In the general case, by \ref{cor:tan-g-delta}, we can find a point $p'$ arbitrarily close to $p$ such that $\T_{p'}\iso \EE^k$ for some $k\le m$.
If $\eps>\dist{p}{p'}{}$, then $\oBall(p,r)\z\subset \oBall(p',r+\eps)$.
Therefore,
\[\vol \oBall(p,r)\le \omega_m\cdot (r+\eps)^m\]
for any $\eps>0$.
Hence \ref{SHORT.inq:BG:b} follows.

Now, suppose $0<r_1<r_2$.
Consider the map $w\: \spc{A}\to \spc{A}$ defined by $w\:x\mapsto \gamma_x(\tfrac {r_1}{r_2})$.
(This map mimics the dilation with center at $p$ and coefficient $\tfrac {r_1}{r_2}$.)
By comparison,
\[\dist{w(x)}{w(y)}{}\ge \tfrac {r_1}{r_2}\cdot \dist{x}{y}{}.\]
Observe that $\oBall(p,r_1) \supset w[\oBall(p,r_2)]$.
Therefore, 
\[\vol \oBall(p,r_1)\ge (\tfrac {r_1}{r_2})^m\cdot\vol \oBall(p,r_2).\]
\qedsf

The following exercise generalizes the Bishop--Gromov inequality to $\Alex{-1}$ case;
it is sufficient for most applications.
A more exact statement for $\Alex\kappa$ spaces is given in \ref{inq:BG+}.



\begin{thm}[!]{Exercise}\label{ex:BG}
Let $\spc{A}$ be a finite-dimensional $\Alex{-1}$ space;
so $\LinDim\spc{A}=m<\infty$.
Show that
\[\vol \oBall(p,r)\le \omega_m\cdot(\sinh r)^m,\]
where $\omega_m$ denotes the volume of the unit ball in $\EE^m$.
Moreover, the function 
\[r\mapsto \frac{\vol B(p,r)}{(\sinh r)^m}\]
is nonincreasing.
\end{thm}

\begin{thm}[!]{Exercise}\label{ex:diam-compact:proper}
Show that any finite-dimensional Alexandrov space is proper.

\end{thm}

\begin{thm}{Exercise}\label{ex:vol>0}
Show that any nonempty open set in an $m$-dimensional Alexandrov space has positive $m$-volume.
\end{thm}


\section{Packing numbers}\label{sec:packing-numbers}


\begin{thm}{Exercise}\label{ex:tangent=Em}
Let $\spc{A}$ be an $m$-dimensional $\Alex\kappa$ space and $m<\infty$.

\begin{subthm}{ex:tangent=Em:2balls}
Show that for any two balls $B_1$ and $B_2$ in $\spc{A}$ with positive radii
there is $\delta>0$ such that the inequality
$\pack_{\delta\cdot\eps} B_1\ge \pack_\eps B_2$
holds for all sufficiently small $\eps>0$.
\end{subthm}

\begin{subthm}{ex:tangent=Em:ball}
Show that there are constants $c_1=c_1(m)$ and $c_2=c_2(m,r,\kappa)$ such that
\[c_1\cdot \vol B\le\eps^m\cdot\pack_\eps B\le c_2\cdot \vol B\]
for any ball $B=\cBall[p,r]_{\spc{A}}$ with $r>0$ and all small $\eps>0$.
\end{subthm}

\end{thm}


Note that the exercise above implies that for Alexandrov spaces \index{Minkowski dimension}\emph{Minkowski dimension} (also known as \index{box-counting dimension}\emph{box-counting dimension}) coincides with linear dimension.
Namely, let $\spc{A}$ be an Alexandrov space.
Given a point $p\in \spc{A}$ and $r>0$, let
\[m(p,r)\df \inf\set{\alpha\in\RR}{\eps^\alpha\cdot\pack_\eps \cBall[p,r]\to 0\quad\text{as}\quad \eps\to 0}.\]
Then $m(p,r)=\LinDim \spc{A}$; in particular, $m(p,r)$ is an integer, and it does not depend on the choice of $p$ and $r$.


\section{Other dimensions}\label{sec:all-dim}

Now we want to show that \textit{all reasonable definitions of dimension give the same result for Alexandrov spaces}.
More precisely, we have the following theorem; compare to \cite[15.16]{alexander-kapovitch-petrunin2024}.
We refer to \cite{hurewicz-wallman} for definitions of \index{Lebesgue covering dimension}\emph{Lebesgue covering dimension} and \index{Hausdorff!dimension}\emph{Hausdorff dimension}, which will be denoted by \index{TopDim@$\TopDim$}$\TopDim$ and
\index{HausDim@$\HausDim$}$\HausDim$, respectively.

\begin{thm}{Theorem}\label{thm:dim=dim}
For any Alexandrov space $\spc{A}$, we have
\[\LinDim \spc{A}=\TopDim \spc{A}=\HausDim \spc{A}.\]
\end{thm}

\parit{Proof.}
Suppose $\LinDim \spc{A}=\infty$.
By the right-inverse theorem (\ref{thm:right-inverse}), $\spc{A}$ contains a compact subset $K$ with  arbitrarily large $\TopDim K$.
In particular,
\[\TopDim\spc{A}=\infty.\] 
By Szpilrajn's theorem,
$\HausDim K\ge \TopDim K$.
Thus we also have 
\[\HausDim\spc{A}=\infty.\]

Now suppose $\LinDim \spc{A}=m<\infty$.
By the Bishop--Gromov inequality (\ref{inq:BG} and \ref{ex:BG}), 
\[\HausDim\spc{A}\le m.\]

Since $\spc{A}$ is proper (\ref{ex:diam-compact:proper}),
Szpilrajn's theorem implies that
\[\TopDim\spc{A}\le \HausDim\spc{A}\le m.\]
Finally, by the right-inverse theorem (\ref{thm:right-inverse}), $m\le\TopDim\spc{A}$.
\qeds

\begin{thm}{Exercise}\label{ex:dim=dim}
Let $\Omega$ be an open subset of Alexandrov space $\spc{A}$.
Show that 
\[\LinDim \spc{A}=\LinDim \Omega=\TopDim \Omega=\HausDim \Omega.\]
\end{thm}

\begin{thm}[!]{Exercise}\label{ex:finite-tan}
Let $p$ be a point in a finite-dimensional Alexandrov space $\spc{A}$.
Prove the following.
\begin{subthm}{ex:finite-tan:tan}
The tangent space $\T_p$ is a proper $\Alex0$ space.
\end{subthm}

\begin{subthm}{ex:finite-space-of-directions-dim}
$\LinDim\Sigma_p+1=\LinDim\T_p=\LinDim\spc{A}$.
\end{subthm}

\begin{subthm}{ex:finite-tan:sigma}
If $\LinDim \spc{A}>1$, then $\Sigma_p$ is geodesic.
\end{subthm}

\end{thm}

Part \ref{SHORT.ex:finite-space-of-directions-dim} of the exercise, opens a way to use induction on dimension of Alexandrov space.
It will be used extensively in Lecture~\ref{chap:bry}.

\section{Remarks}

The proof of the following version of the Bishop--Gromov inequality requires additionally the so-called \textit{coarea formula} for Alexandrov spaces.
The weaker inequality from \ref{ex:BG} is sufficient for the sequel.

\begin{thm}{Optimal Bishop--Gromov inequality}\label{inq:BG+}
Given a point $p$ in an $m$-dimensional $\Alex\kappa$ space,
consider the function
\[v\:r\z\to\vol_m\oBall(p,r);\]
denote by $\tilde v(r)$ the volume of $r$-ball in $\MM^m(\kappa)$.
Then 
\[v(r)\le \tilde v(r)\]
for any $r>0$.
Moreover, the function
\[r\mapsto \frac{v(r)}{\tilde v(r)}\] is nonincreasing.
If $\kappa>0$, then one has to assume that $r<\tfrac\pi{\sqrt\kappa}$.
\end{thm}

This inequality was originally proved for Riemannian manifolds with lower Ricci curvature.
The first part is also known as \emph{Bishop's inequality}.
It is due to Richard Bishop; see \cite{bishop1964} and \cite[Corollary 4, p. 256]{bishop-crittenden}.
The second part is due to Michael Gromov \cite{gromov1981}.

Theorem~\ref{thm:dim=dim}, was essentially proved by Conrad Plaut \cite{plaut:dimension}.
At that time, it was not known whether
\[\LinDim\spc{A}=\infty\quad \Rightarrow\quad \TopDim\spc{A}=\infty\]
for any Alexandrov space $\spc{A}$.
The latter implication was proved by Grigory Perelman and the third author \cite{perelman-petrunin:qg}.

