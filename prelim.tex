%%!TEX root = the-prelim.tex

\chapter{Preliminaries}\label{chap:prelim}

\section{Prerequisites}

The main prerequisite: the reader should know and love elementary geometry, including convexity.

We also assume that the reader is familiar with the following topics in metric geometry:
\begin{itemize}
\item Compactness and proper metric spaces;
recall that a metric space is \index{proper space}\emph{proper} if all its closed balls (of finite radius) are compact.
\item Complete metric spaces and completion.
\item Curves, semicontinuity of length, and rectifiability.
\item Hausdorff and Gromov--Hausdorff convergence.
These are discussed briefly in \ref{sec:Hausdorff convergence}--\ref{sec:Almost isometries}.
The definitions are there, but some prior familiarity with these concepts will be very helpful
%it would be hard to follow without prior experience.
\end{itemize}
All these topics are treated in detail in the classic book of Dmitri Burago, Yurii Burago, and Sergei Ivanov \cite{burago-burago-ivanov}; see also a short book of second author \cite{petrunin2023pure}.
Occasionally, we use the Baire category theorem and Rademacher's theorem, but these could be used as black boxes.

We use some topology. 
An introductory text in algebraic topology should be sufficient most of the time.
For some examples, we apply more advanced results, but these are used as black boxes.

Since most of the applications come from Riemannian geometry, it is beneficial to be familiar with the Toponogov comparison theorem and related topics.
The classical book by Jeff Cheeger and David Ebin \cite{cheeger-ebin} contains more than one needs.

\section{Notations}

The distance between two points $x$ and $y$ in a metric space $\spc{X}$ will be denoted by \index{9@$\dist{x}{y}{}=\dist{x}{y}{\spc{X}}$ (distance)}$\dist{x}{y}{}$ or $\dist{x}{y}{\spc{X}}$.\label{page:|x-y|X}
The latter notation is used if we need to emphasize 
that the distance is taken in the space~${\spc{X}}$.

Given radius $r\in[0,\infty]$ and center $x\in \spc{X}$, the sets
\begin{align*}
\oBall(x,r)&=\set{y\in \spc{X}}{\dist{x}{y}{}<r},
\\
\cBall[x,r]&=\set{y\in \spc{X}}{\dist{x}{y}{}\le r}
\end{align*}
are called, respectively, the \index{open ball}\emph{open} and  the \index{closed ball}\emph{closed  balls}.
The notations $\oBall(x,r)_{\spc{X}}$ and $\cBall[x,r]_{\spc{X}}$
might be used if we need to emphasize that these balls are taken in the metric space $\spc{X}$.

The \index{diameter}\emph{diameter} of $\spc{X}$ is  defined as
\[\diam \spc{X}=\sup\set{\dist{x}{y}{}}{x,y\in \spc{X}}.\]

The \index{radius}\emph{radius} of $\spc{X}$ is  defined as
\[\rad \spc{X}=\inf\set{R>0}{\oBall(x,R)= \spc{X}\ \text{for some}\ x\in\spc{X}}.\]

We will denote by \index{60@$\SSS^n$, $\EE^n$, $\HH^n$, and $\MM^n(\kappa)$}$\SSS^n$, $\EE^n$, and $\HH^n$ the $n$-dimensional sphere (with angle metric),
the Euclidean space, and the Lobachevsky space respectively.
More generally, $\MM^n(\kappa)$ will denote the \index{model!space}\emph{model $n$-space} of curvature $\kappa$;
that is,
\begin{itemize}
\item if $\kappa>0$, then $\MM^n(\kappa)$ is the $n$-sphere of radius $\tfrac{1}{\sqrt{\kappa}}$, so $\SSS^n=\MM^n(1)$
\item $\MM^n(0)=\EE^n$,
\item if $\kappa<0$, then $\MM^n(\kappa)$ is the Lobachevsky $n$-space $\HH^n$ rescaled by factor $\tfrac{1}{\sqrt{-\kappa}}$;
in particular $\MM^n(-1)=\HH^n$.
\end{itemize}

\section{Nets and packing}\label{sec:packing}

Let $S$ be a subset of a metric space $\spc{X}$.
Recall that a set $Z\subset \spc{X}$ is called an \index{net@$\eps$-net}\emph{$\eps$-net} of $S$ if for any point $s\in S$, there is a point $z\in Z$ such that $\dist{s}{z}{}\le\eps$.

The \index{$\eps$-pack}\emph{$\eps$-pack} of $\spc{X}$ (or \index{packing number}\emph{packing number}) is the maximal number  (possibly infinite) of points in $\spc{X}$ at distance $>\eps$ from each other;  it is denoted by $\pack_\eps\spc{X}$\index{$\pack_\eps\spc{X}$}.
If $m=\pack_\eps\spc{X}<\infty$, then a set $\{x_1,x_2,\dots,x_m\}$ in $\spc{X}$
such that $\dist{x_i}{x_j}{}>\eps$ is called a \index{maximal packing}\emph{maximal $\eps$-packing} in $\spc{X}$.

We will use the following characterizations of compact sets.

\begin{thm}[!]{Exercise}\label{ex:net}
Let $X$ be a closed subset in a complete metric space.

\begin{subthm}{ex:net:finite}
Show that $X$ is compact if and only if it admits a finite $\eps$-net for any $\eps>0$.
\end{subthm}

\begin{subthm}{ex:net:compact}
Show that $X$ is compact if and only if it admits a compact $\eps$-net for any $\eps>0$.
\end{subthm}

\end{thm}

\begin{thm}[!]{Exercise}\label{ex:pack-net}
Show that any maximal $\eps$-packing $x_1,\dots,x_n$ is an $\eps$-net.
Conclude that a complete metric space $\spc{X}$ is compact if and only if $\pack_\eps\spc{X}\z<\infty$ for any $\eps>0$.
\end{thm}

\section{Length spaces}\label{sec:length}

Let $\spc{X}$ be a metric space.
If for any $\eps>0$ and any pair of points $x,y\in\spc{X}$, there is a path $\alpha$ connecting $x$ to $y$ such that
\[\length\alpha< \dist{x}{y}{}+\eps,\]
then $\spc{X}$ is called a \index{length space}\emph{length space} and the metric on $\spc{X}$ is called a \index{length metric}\emph{length metric}.\label{page:length metric}

\begin{thm}{Exercise}\label{ex:compact+connceted}
Let $\spc{X}$ be a complete length space.
Show that for any compact subset $K\subset\spc{X}$
there is a compact path-connected subset $K'\subset\spc{X}$ that contains $K$.  
\end{thm}

\parbf{Induced length metric.}
Directly from the definition, it follows that if $\alpha\:[0,1]\to\spc{X}$ is a path from $x$ to $y$ 
(that is, $\alpha(0)=x$ and $\alpha(1)=y$), then 
\[\length\alpha\ge \dist{x}{y}{}.\]
Set 
\[\yetdist{x}{y}{}=\inf\{\,\length\alpha\,\},\]
where the greatest lower bound is taken for all paths from $x$ to~$y$.
It is straightforward to check that $(x,y)\mapsto \yetdist{x}{y}{}$ is an \emph{$\infty$-metric};
that is, $(x,y)\mapsto \yetdist{x}{y}{}$ is a metric in the extended positive reals $[0,\infty]$. 
The metric $\yetdist{*}{*}{}$ is called the \index{induced length metric}\emph{induced length metric}.

\begin{thm}{Exercise}\label{ex:compact=>complete}
Suppose $(\spc{X},\dist{*}{*}{})$ is a complete metric space.
Show that $(\spc{X},\yetdist{*}{*}{})$ is complete;
that is, any Cauchy sequence of points in $(\spc{X},\yetdist{*}{*}{})$ converges in $(\spc{X},\yetdist{*}{*}{})$.
\end{thm}

Let $A$ be a subset of a metric space $\spc{X}$.
Given two points $x,y\in A$,
consider the value
\[\dist{x}{y}{A}=\inf_{\alpha}\{\,\length\alpha\,\},
\]
%???V: I think it would be more natural to denote it $\yetdist{x}{y}{A}$ --- A: Maybe it is more natural, but it is not convinient --- it is better to have one notation form metric.
where the greatest lower bound is taken for all paths $\alpha$ from $x$ to $y$ in~$A$.
In other words, $\dist{*}{*}{A}$ denotes the induced length metric on the subspace $A$.
(The notation $\dist{*}{*}{A}$ conflicts with the previously defined notation for distance $\dist{x}{y}{\spc{X}}$ in a metric space $\spc{X}$.
However, most of the time we will work with ambient length spaces where the meaning will be unambiguous.)

\section{Geodesics}

Let $\spc{X}$ be a metric space,
and let $\II$\index{60@$\II$ (real interval)} be a real interval.
A distance-preserving map $\gamma\:\II\to \spc{X}$ is called a \index{geodesic}\emph{geodesic}%
\footnote{Other texts  may refer to geodesics in our sense of the word as  \textit{shortest path} or \textit{minimizing geodesic}.
Also, our meaning of the term \textit{geodesic} is closely related, but different from what is used in Riemannian geometry.};
in other words, $\gamma\:\II\z\to \spc{X}$ is a geodesic if 
\[\dist{\gamma(s)}{\gamma(t)}{}=|s-t|\]
for any pair $s,t\in \II$.

If $\gamma\:[a,b]\to \spc{X}$ is a geodesic such that $p=\gamma(a)$, $q=\gamma(b)$, then we say that $\gamma$ is a geodesic from $p$ to $q$.
In this case, the image of $\gamma$ is denoted by $[p q]$\index{10@$[pq]=[p q]_{\spc{X}}$ (geodesic)}, and, with abuse of notations, we also call it a \index{geodesic}\emph{geodesic}.
We may write $[p q]_{\spc{X}}$ 
to emphasize that the geodesic $[p q]$ lies in the space ${\spc{X}}$.

In general, a geodesic from $p$ to $q$ need not exist and if it exists, it need not  be unique;
for example, any meridian is a geodesic between poles on the sphere.
However, once we write $[p q]$ we assume that we have chosen such a geodesic.

A \index{geodesic!path}\emph{geodesic path} is a geodesic with constant-speed reparameterization by the unit interval $[0,1]$.

A metric space is called \index{geodesic!space}\emph{geodesic} if any pair of its points can be joined by a geodesic.
A metric space $\spc{X}$ is called \index{91@$\ell$-geodesic space}\emph{$\ell$-geodesic}
if any two points $x,y\in\spc{X}$ such that $\dist{x}{y}{}<\ell$ can be connected by a geodesic.
For instance, any geodesic space is $\infty$-geodesic.

Evidently, any geodesic space is a length space.

\begin{thm}{Exercise}\label{ex:compact-length}
Show that any proper length space is geodesic.
\end{thm}

\section{Menger's lemma}

\begin{thm}{Lemma}\label{lem:mid>geod}
Let $\spc{X}$ be a complete metric space.
Assume that for any pair of points $x,y\in \spc{X}$, 
there is a midpoint~$z$.
Then $\spc{X}$ is a geodesic space.

\end{thm}

This lemma is due to Karl Menger \cite[Section 6]{menger}.

%???+PIC!!!

\parit{Proof.}
Choose $x,y\in \spc{X}$;
set $\gamma(0)=x$, and $\gamma(1)=y$.

\begin{figure}[ht!]
\vskip-0mm
\centering
\includegraphics{mppics/pic-104}
\end{figure}

Let $\gamma(\tfrac12)$ be a midpoint between $\gamma(0)$ and $\gamma(1)$.
Further, let $\gamma(\frac14)$ 
and $\gamma(\frac34)$ be midpoints between the pairs $(\gamma(0),\gamma(\tfrac12))$ 
and $(\gamma(\tfrac12),\gamma(1))$ respectively.
Applying the above procedure recursively,
on the $n$-th step we define $\gamma(\tfrac{k}{2^n})$,
for every odd integer $k$ such that $0<\tfrac k{2^n}<1$, 
as a midpoint of the already defined
$\gamma(\tfrac{k-1}{2^n})$ and $\gamma(\tfrac{k+1}{2^n})$.

This way we define $\gamma(t)$ for all dyadic rationals $t$ in $[0,1]$.
Moreover, the map $\gamma$ has Lipschitz constant $\dist{x}{y}{}$.
Since $\spc{X}$ is complete, $\gamma$ can be extended continuously to $[0,1]$.
Moreover,
\[
\length\gamma\le \dist{x}{y}{}.
\]
Therefore $\gamma$ is a geodesic path from $x$ to $y$.
\qedsf

\begin{thm}{Exercise}\label{ex:menger}
Let $\spc{X}$ be a complete metric space.
Assume that for any pair of points $x,y\in \spc{X}$, 
there is an \index{almost midpoint}\emph{almost midpoint};
that is, given $\eps>0$, there is a point $z$ such that 
\[\dist{x}{z}{}<\tfrac12\cdot\dist{x}{y}{}+\eps 
\quad\text{and}\quad
\dist{y}{z}{}<\tfrac12\cdot\dist{x}{y}{}+\eps.\]
Show that $\spc{X}$ is a length space.
\end{thm}


\section{Triangles and model triangles}

\parbf{Triangles.}
Given a triple of points $p,q,r$ in a metric space $\spc{X}$, a choice of geodesics $([q r], [r p], [p q])$ will be called a \index{triangle}\emph{triangle} and denoted by $\trig p q r=\trig p q r_{\spc{X}}$\index{10@$\trig p q r=\trig p q r_{\spc{X}}$ (triangle)}.

Given a triple of points $p,q,r\in \spc{X}$ there may be no triangle
$\trig p q r$ simply because one of the pairs of these points cannot be joined by a geodesic.
Also, many different triangles with these vertices may exist, any of which can be denoted by $\trig p q r$.
If we write $\trig p q r$, it means that we have chosen such a triangle.


\parbf{Model triangles.}
Given three points $p,q,r$ in a metric space $\spc{X}$,
let us define the \index{model!triangle}\emph{model triangle} $\trig{\tilde p}{\tilde q}{\tilde r}$ 
(briefly, 
$\trig{\tilde p}{\tilde q}{\tilde r}=\modtrig(p q r)_{\EE^2}$%
\index{20@$\modtrig$ (model triangle)}) to be a triangle in the Euclidean plane $\EE^2$ with the same sides;
that is,
\[
\dist{\tilde p}{\tilde q}{\EE^2}=\dist{p}{q}{\spc{X}},
\quad\dist{\tilde q}{\tilde r}{\EE^2}=\dist{q}{r}{\spc{X}},
\quad\dist{\tilde r}{\tilde p}{\EE^2}=\dist{r}{p}{\spc{X}}.
\]

In the same way, we can define the \index{hyperbolic model triangle}\emph{hyperbolic} and the \index{spherical model triangles}\emph{spherical model triangles} $\modtrig(p q r)_{\HH^2}$, $\modtrig(p q r)_{\SSS^2}$
in the Lobachevsky plane $\HH^2$ and the unit sphere~$\SSS^2$.
In the latter case, the model triangle is said to be defined if in addition
\[\dist{p}{q}{}+\dist{q}{r}{}+\dist{r}{p}{}< 2\cdot\pi.\]
In this case, the model triangle again exists and is unique up to an isometry of~$\SSS^2$.

\parbf{Model angles.}
If 
$\trig{\tilde p}{\tilde q}{\tilde r}=\modtrig(p q r)_{\EE^2}$ 
and $\dist{p}{q}{},\dist{p}{r}{}>0$, 
the angle measure of 
$\trig{\tilde p}{\tilde q}{\tilde r}$ at $\tilde p$ 
will be called the \index{model!angle}\emph{model angle} of the triple $p$, $q$, $r$ and will be denoted by
$\angk p q r_{\EE^2}$%
\index{30@$\angk{p}{q}{r}$ (model angle)}.\label{page:model-angle}

For example, if $\dist{p}{q}{}=\dist{q}{r}{}=\dist{r}{p}{}$, then $\angk p q r_{\EE^2}=\tfrac\pi3$ regardless of the existence and relative position of geodesics $[pq]$ and $[pr]$.

In the same way we define $\angk p q r_{\MM^2(\kappa)}$;
in particular, $\angk p q r_{\HH^2}$ and $\angk p q r_{\SSS^2}$.
We may use the notation $\angk p q r$ if it is evident which of the model spaces is meant.

\begin{thm}[!]{Exercise}\label{ex:k-><mono}
Show that for any triple of points $p$, $q$, and $r$,
the function
\[\kappa\mapsto \angk p q r_{\MM^2(\kappa)}\]
is nondecreasing in its domain of definition.
\end{thm}


\section{Hinges and their angle measure}\label{sec:angles}

\parbf{Hinges.} Let $p,x,y\in \spc{X}$ be a triple of points such that $p$ is distinct from $x$ and~$y$.
A pair of geodesics $([p x],[p y])$ will be called  a \index{hinge}\emph{hinge} and will be denoted by 
$\hinge p x y=([p x],[p y])$\index{11@$\hinge p x y$ (hinge)}.

\parbf{Angles.}
The angle measure of a hinge $\hinge p x y$ is defined as the following limit
\[\mangle\hinge p x y=\lim_{\bar x,\bar y\to p} \angk p{\bar x}{\bar y},\]
where $\bar x\in\left]p x\right]$ and $\bar y\in\left]p y\right]$ (The angle is only defined if this limit exists).

If $\mangle\hinge p x y$ is defined, then
\[0\le \mangle\hinge p x y\le \pi.\]

\begin{thm}{Exercise}\label{ex:angkK}
Suppose that in the above definition, one uses spherical or hyperbolic model angles instead of Euclidean ones.
Show that it does not change the value $\mangle\hinge p x y$.
\end{thm}


\begin{thm}{Exercise}\label{ex:undefined-angle}
Give an example of a hinge $\hinge p x y$ in a metric space with an undefined angle measure $\mangle\hinge p x y$.
\end{thm}

\section{Triangle inequality for angles}

\begin{thm}{Proposition}\label{claim:angle-3angle-inq}
Let  $[px_1]$, $[px_2]$, and $[px_3]$ be three geodesics in a metric space.
Suppose all the angle measures $\alpha_{i, j}=\mangle\hinge p {x_i}{x_j}$ are defined.
Then 
\[\alpha_{1,3}\le \alpha_{1,2}+\alpha_{2,3}.\]

\end{thm}



\parit{Proof.}
Since $\alpha_{1,3}\le\pi$, we can assume that $\alpha_{1,2}+\alpha_{2,3}< \pi$.
Denote by $\gamma_i$ the unit-speed parametrization of $[px_i]$ from $p$ to $x_i$.
Given any $\eps>0$, for all sufficiently small $t,\tau,s\in[0,\infty)$ we have
\begin{align*}
\dist{\gamma_1(t)}{\gamma_3(\tau)}{}
&\le 
\dist{\gamma_1(t)}{\gamma_2(s)}{}+\dist{\gamma_2(s)}{\gamma_3(\tau)}{}<\\
&<
\sqrt{t^2+s^2-2\cdot t\cdot  s\cdot \cos(\alpha_{1,2}+\eps)} +
\\
&\quad+\sqrt{s^2+\tau^2-2\cdot s\cdot \tau\cdot \cos(\alpha_{2,3}+\eps)}\le
\end{align*}

\begin{wrapfigure}{o}{30 mm}
\vskip-16mm
\centering
\includegraphics{mppics/pic-615}
\vskip0mm
\end{wrapfigure}

Below we define 
$s(t,\tau)$ so that for 
$s=s(t,\tau)$, this chain of inequalities can be continued as follows:
\[\le
\sqrt{t^2+\tau^2-2\cdot t\cdot \tau\cdot \cos(\alpha_{1,2}+\alpha_{2,3}+2\cdot \eps)}.
\]

Thus for any $\eps>0$, 
\[\alpha_{1,3}\le \alpha_{1,2}+\alpha_{2,3}+2\cdot \eps.\]
Hence the result follows.

To define $s(t,\tau)$, consider three half-lines $\tilde \gamma_1$, $\tilde \gamma_2$, $\tilde \gamma_3$ on a Euclidean plane starting at one point, such that
$\mangle(\tilde \gamma_1,\tilde \gamma_2)\z=\alpha_{1,2}+\eps$,
$\mangle(\tilde \gamma_2,\tilde \gamma_3)\z=\alpha_{2,3}+\eps$,
and $\mangle(\tilde \gamma_1,\tilde \gamma_3)\z=\alpha_{1,2}\z+\alpha_{2,3}\z+2\cdot \eps$.
We parametrize each half-line by the distance from the starting point.
Given two positive numbers $t,\tau$, let $s=s(t,\tau)$ be
the number such that 
$\tilde \gamma_2(s)\z\in[\tilde \gamma_1(t)\ \tilde \gamma_3(\tau)]$. 
Clearly, $s\le\max\{t,\tau\}$, so $t,\tau,s$ may be taken sufficiently small.
\qeds 

\begin{thm}[!]{Exercise}\label{ex:adjacent-angles}
Prove that the sum of adjacent angles is at least $\pi$.

More precisely: suppose two hinges $\hinge pxz$ and $\hinge pyz$ are \index{adjacent hinges}\emph{adjacent};
that is, they share side $[pz]$, and the union of two sides $[px]$ and $[py]$ forms a geodesic $[xy]$.
Show that
\[\mangle\hinge pxz+\mangle\hinge pyz\ge \pi\]
whenever  each angle on the left-hand side is defined.

Give an example showing that the inequality can be strict.
\end{thm}

\begin{thm}{Exercise}\label{ex:first-var}
Let $\gamma$ be the unit speed parametrization of $[qx]$ from $q$ to $x$.
Assume that the angle measure $\phi=\hinge q p x$ is defined.
Show that
\[\dist{p}{\gamma(t)}{}
\le
\dist{q}{p}{}-t\cdot \cos\phi+o(t).\]

\end{thm}

\section{Hausdorff convergence}\label{sec:Hausdorff convergence}

\begin{thm}{Definition}\label{def:gen-Haus-conv}
Let $A_1,A_2,\dots$ be a sequence of closed sets in a metric space $\spc{X}$.
We say that the sequence $A_n$ \index{Hausdorff!limit}\emph{converges} to a closed set $A_\infty$ in the {}\emph{sense of Hausdorff} if, for any $x\in\spc{X}$, we have
$\distfun_{A_n}(x)\z\to \distfun_{A_\infty}(x)$ as $n\to\infty$.
\end{thm}

For example, suppose $\spc{X}$ is the Euclidean plane and $A_n$ is the circle with radius $n$ and center at the point $(0,n)$.
Then $A_n$ converges to the $x$-axis as $n\to \infty$.

\begin{figure}[ht!]
\vskip-0mm
\centering
\includegraphics{mppics/pic-415}
\end{figure}

Further, consider the sequence of one-point sets $B_n=\{(n,0)\}$ in the Euclidean plane.
It converges to the empty set;
indeed, for any point $x$ we have $\distfun_{B_n}(x)\to\infty$ as $n\to \infty$ and $\distfun_{\emptyset}(x)= \infty$ for any~$x$.

The following exercise is an extension of the so-called Blaschke selection theorem to our version of Hausdorff convergence.

\begin{thm}{Exercise}\label{ex:generalized-selection}
Show that any sequence of closed sets in a proper metric space has a convergent subsequence in the sense of Hausdorff.
\end{thm}


\begin{thm}{Exercise}\label{ex:two>one}
Construct a metric space with a sequence of points $\{x_0,x_1,\dots\}$ such that $\dist{x_0}{x_n}{}=1$ for any $n>0$ and the two-point sets $\{x_0,x_n\}$ converge to one-point set $\{x_0\}$ in the sense of Hausdorff.
\end{thm}


\section{Hausdorff metric}

\begin{thm}{Definition}\label{def:hausdorff-convergence}
Let $A$ and $B$ be two nonempty compact subsets of a metric space $\spc{X}$.
Then the \index{Hausdorff!distance}\emph{Hausdorff distance} between $A$ and $B$ is defined as 
$$|A-B|_{\Haus\spc{X}}
\df
\sup_{x\in \spc{X}}\{\,|\distfun_A(x)-\distfun_B(x)|\,\}.
$$

\end{thm}

The following observation gives a useful reformulation of the definition:

\begin{thm}{Observation}\label{obs:Haus-nbhds}
Suppose $A$ and $B$ are two compact subsets of a metric space $\spc{X}$.
Then $|A-B|_{\Haus\spc{X}}< R$ if and only if
$B$ lies in an $R$-neighborhood of $A$, 
and 
$A$ lies in an $R$-neighborhood of~$B$.
\end{thm}

According to the following exercise, Hausdorff convergence of nonempty compact subsets is the convergence in Hausdorff metric.

\begin{thm}{Exercise}\label{ex:Haus-conv}
Let $A_1,A_2,\dots,$ and $A_\infty$ be compact nonempty sets in a proper metric space $\spc{X}$.
Show that $\dist{A_n}{A_\infty}{\Haus\spc{X}}\to 0$ as $n\to\infty$
if and only if $A_n\to A_\infty$ in the sense of Hausdorff.
\end{thm}

\section{Gromov--Hausdorff convergence}\label{sec:Gromov--Hausdorff}

Let $\spc{X}_1,\spc{X}_2,\dots,$ and $\spc{X}_\infty$ be a sequence of proper metric spaces.
Suppose that there is a metric on the disjoint union 
\[\bm{X}=\bigsqcup_{n\in \NN\cup\{\infty\}} \spc{X}_n\] 
that satisfies the following property:

\begin{thm}{Property}\label{propery:GH}
The restriction of the metric on each $\spc{X}_n$ and $\spc{X}_\infty$ coincides with its original metric,
the space $\bm{X}$ is proper,
and $\spc{X}_n\z\to \spc{X}_\infty$ as subsets in $\bm{X}$ in the sense of Hausdorff.
\end{thm}

In this case we say that the metric on $\bm{X}$ \textit{defines} a \index{Gromov--Hausdorff limit}\emph{convergence} $\spc{X}_n\z\to \spc{X}_\infty$ in the {}\emph{sense of Gromov--Hausdorff}.
The metric on  $\bigsqcup \spc{X}_n$ makes it possible to talk about limits of sequences $x_n\in \spc{X}_n$ as $n\to\infty$, as well as weak limits of a sequence of Borel measures $\mu_n$ on $\spc{X}_n$ and so on.

The limit space is not uniquely defined by the sequence.
For example, if each space $\spc{X}_n$ in the sequence is isometric to the half-line, then its limit might be isometric to the half-line or the whole line.
The first convergence is evident and the second could be guessed from the picture.

\begin{figure}[ht!]
\vskip-0mm
\centering
\includegraphics{mppics/pic-500}
\end{figure}

Note that any sequence of spaces has an empty space as its limit in some  Gromov--Hausdorff convergence.
As we will see further, if the limit is nonempty and compact, then it is unique up to isometry.

\parbf{Pointed convergence.}
The isometry class of the limit can be fixed by marking a point $p_n$ in each space $\spc{X}_n$.
We say that $(\spc{X}_n,p_n)$ converges to $(\spc{X}_\infty,p_\infty)$ if there is a metric on $\bm{X}$ as in \ref{propery:GH} such that $p_n\to p_\infty$.
This is called \index{pointed convergence}\emph{pointed Gromov--Hausdorff convergence}.
For example, the sequence $(\spc{X}_n,p_n)=([0,\infty),0)$ converges to $([0,\infty),0)$, while $(\spc{X}_n,p_n)=([0,\infty),n)$ converges to $(\RR,0)$ as $n\to \infty$.

\section{Gromov--Hausdorff metric}\label{sec:Gromov--Hausdorff-metric}

In this section we cook up a metric space out of all compact nonempty metric spaces
that defines Gromov--Hausdorff convergence.
We want to define the metric on the set of \textit{isometry classes} of compact metric spaces.
Further, the term \textit{metric space} might also stand for its \textit{isometry class}.

Loosely speaking, the distance between (isometry classes of) compact metric spaces will be defined as the maximal value such that \textit{the distance between subspaces in a metric space is not greater than the Hausdorff distance between them}.

Observe that we \textit{know} a real number $x$ if we can give yes/no answer to the question $x<r$ for any $r$.
Keep this in mind while reading the following definition.

\begin{thm}{Definition}\label{def:GH}
The \index{Gromov--Hausdorff distance}\emph{Gromov--Hausdorff distance} $|\spc{X}-\spc{Y}|_{\GH}$ between compact metric spaces $\spc{X}$ and $\spc{Y}$
is defined by the following
relation.

Given  $r > 0$, we have $|\spc{X}-\spc{Y}|_{\GH} < r$ if and only if there exists a metric
space $\spc{W}$ and subspaces $\spc{X}'$ and $\spc{Y}'$ in $\spc{W}$ that are isometric to $\spc{X}$ and $\spc{Y}$,
respectively, such that $|\spc{X}'-\spc{Y}'|_{\Haus\spc{W}} < r$.
(Here $|\spc{X}'\z-\spc{Y}'|_{\Haus\spc{W}}$ denotes the Hausdorff distance between sets $\spc{X}'$ and $\spc{Y}'$ in $\spc{W}$.)
\end{thm}

These distances actually define a metric on (isometry classes of) compact metric spaces; for a proof we refer to \cite{burago-burago-ivanov,petrunin2023pure}.
The obtained metric is called the Gromov--Hausdorff metric;
the corresponding metric space will be denoted by $\GH$.
This means in particular that if $|\spc{X}-\spc{Y}|_{\GH}\z=0$ for compact metric spaces $X$ and $Y$, then they are isometric.
Moreover, each of the references above provide the following statement.

\begin{thm}{Proposition}\label{prop:complete}
$\GH$ is a complete metric space.
\end{thm}

The proofs of the mentioned statements are not quite straightforward.
The following two exercises should help the reader who wants to reconstruct these proofs without reading the mentioned textbooks.


\begin{thm}{Exercise}\label{ex:non-contracting-map}
Let $f$ be a distance noncontracting map from
a compact metric space $\spc{K}$ to itself.
Show that $f$ is an isometry; that is, it is a distance-preserving bijection.
\end{thm}

\begin{thm}{Exercise}\label{ex:non-expanding-map}
Show that any surjective \index{short map}\emph{short} map (that is, distance-nonexpanding) from a compact metric space to itself is an isometry.
\end{thm}

\parbf{Two convergences.}
Notice that now we have two notions of convergence of metric spaces.
One is defined in the previous section; it works for proper metric spaces and
its limit might not be uniquely defined.
The other is defined as convergence in $\GH$;
the limit in $\GH$ is unique, if it exists.
Therefore, these convergences are different.
On the other hand, if we restrict our attention only to nonempty compact spaces, then these two convergences are essentially the same.
Let us sketch why.

Suppose $|\spc{X}_n-\spc{X}_\infty|_{\GH}\to 0$ as $n\to \infty$;
that is $\spc{X}_n$ converges to $\spc{X}_\infty$ in $\GH$.
Then there is a metric on $\spc{V}_n=\spc{X}_n\sqcup \spc{X}_\infty$ such that the restriction of metric on each $\spc{X}_n$ and $\spc{X}_\infty$ coincides with its original metric, and $\dist{\spc{X}_n}{\spc{X}_\infty}{\Haus\spc{V}_n}<\eps_n$ for some sequence $\eps_n\to 0$.
Gluing all $\spc{V}_n$ along $\spc{X}_\infty$, we get the required space $\bm{X}$, which defines convergence.

Once the convergence is fixed, we can talk about limits of sequences $x_n\in \spc{X}_n$ in $\spc{X}_\infty$ as $n\to\infty$, as well as weak limits of a sequence of Borel measures $\mu_n$ on $\spc{X}_n$ and so on --- all these limits are defined as the corresponding limits in the ambient space $\bm{X}$.

Now suppose we have a Gromov--Hausdorff convergence $\spc{X}_n\to \spc{X}_\infty$ with the common space $\bm{X}$.
Assume that all spaces $\spc{X}_1,\spc{X}_2,\dots$, as well as $\spc{X}_\infty$ are compact, and $\spc{X}_\infty$ is nonempty.
(The latter condition means that the convergence is nontrivial.)
Observe that in this case $\dist{\spc{X}_n}{\spc{X}_\infty}{\Haus\bm{X}}\to 0$ as $n\to \infty$,
and therefore $\dist{\spc{X}_n}{\spc{X}_\infty}{\GH}\to 0$.
In other words $\spc{X}_n$ converges to $\spc{X}_\infty$ in $\GH$.

\section{Almost isometries}\label{sec:Almost isometries}

\begin{thm}{Definition}
Let $\spc{X}$ and $\spc{Y}$ be metric spaces.
A map $f\:\spc{X}\to\spc{Y}$
is called an \index{isometry!$\eps$-isometry}\emph{$\eps$-isometry}
if the following two conditions hold:

\begin{subthm}{}
$f(\spc{X})$ is an \index{net@$\eps$-net}\emph{$\eps$-net} in $\spc{Y}$; that is, for any $y\in \spc{Y}$ there is $x\in \spc{X}$ such that
\[\dist{f(x)}{y}{\spc{Y}}\le\eps.\]
\end{subthm}

\begin{subthm}{}
$f(\spc{X})$ is \index{distance-preserving}\emph{$\eps$-distance-preserving}; that is,
\[\dist{f(x)}{f(x')}{\spc{Y}}\lg \dist{x}{x'}{\spc{X}}\pm\eps \]
for any $x,x'\in\spc{X}$.
\end{subthm}

\end{thm}

When dealing with Gromov--Hausdorff convergence the following lemma allows to bypass constructing explicit metrics on the disjoint unions of $\spc{X}_1,\spc{X}_2,\dots$, and $\spc{X}_\infty$

\begin{thm}{Lemma}\label{lem:almost-isom}
Let $\spc{X}_1,\spc{X}_2,\dots$, and $\spc{X}_\infty$ be compact metric spaces,
and let $\eps_n\to\0+$ as $n\to\infty$.
Suppose that either 
\begin{subthm}{lem:almost-isom-a}
for each $n$ there is an $\eps_n$-isometry $f_n\:\spc{X}_n\to\spc{X}_\infty$, or
\end{subthm}
\begin{subthm}{lem:almost-isom-b}
for each $n$ there is an $\eps_n$-isometry $h_n\:\spc{X}_\infty\to\spc{X}_n$.
\end{subthm}
Then there is a Gromov--Hausdorff convergence $\spc{X}_n\to \spc{X}_\infty$.

Furthermore, a partial converse also holds.

\begin{subthm}{lem:almost-isom-c}
Suppose we have a Gromov--Hausdorff convergence $\spc{X}_n\to \spc{X}_\infty$ and $\spc{X}_\infty$ is nonempty and compact.
Then there exist $\eps_n\to\0+$ as $n\to\infty$ and $\eps_n$-isometries $f_n\:\spc{X}_n\to\spc{X}_\infty$ (and $h_n\:\spc{X}_\infty\to\spc{X}_n$)
such that $x_n\in \spc{X}_n$ converges to $x_\infty \in  \spc{X}_\infty$ with respect to the  convergence $\spc{X}_n\z\to \spc{X}_\infty$ if and only if $f_n(x_n)\to x_\infty$ (respectively, $\dist{h_n(x_\infty) }{x_n}{\spc{X}_n}\to 0$) as $n\to\infty$.
\end{subthm}
\end{thm}


\parit{Proof.}
To prove part \ref{SHORT.lem:almost-isom-a} let us construct a common space $\bm{X}$ for the spaces $\spc{X}_1,\spc{X}_2,\dots$, and $\spc{X}_\infty$
by taking the metric $\rho$ on the disjoint union $\spc{X}_\infty\sqcup\spc{X}_1\sqcup\spc{X}_2\sqcup\dots$ that is defined the following way:
\begin{align*}
\dist{x_n}{y_n}{\bm{X}}&=\dist{x_n}{y_n}{\spc{X}_n},
\\
\dist{x_\infty}{y_\infty}{\bm{X}}&=\dist{x_\infty}{y_\infty}{\spc{X}_\infty},
\\
\dist{x_n}{x_\infty}{\bm{X}}&=\inf\set{\dist{x_n}{y_n}{\spc{X}_n}+\eps_n+\dist{x_\infty}{f(y_n)}{\spc{X}_\infty}}{{y_n}\in \spc{X}_n},
\\
\dist{x_n}{x_m}{\bm{X}}&=\inf\set{\dist{x_n}{y_\infty}{\bm{X}}+\dist{x_m}{y_\infty}{\bm{X}}}{y_\infty\in\spc{X}_\infty},
\end{align*}
where we assume that $x_\infty,y_\infty\in \spc{X}_\infty$, and $x_n,y_n\in \spc{X}_n$ for each $n$. 
It remains to observe that this indeed defines a metric on $\bm{X}$, and $\spc{X}_n\to \spc{X}_\infty$ in the sense of Hausdorff.

The proof of the second part is analogous; one only needs to change one line in the definition of the metric as follows:
\[\dist{x_n}{x_\infty}{\bm{X}}=\inf\set{\dist{x_n}{h(y_\infty)}{\spc{X}_n}+\eps_n+\dist{x_\infty}{y_\infty}{\spc{X}_\infty}}{{y_\infty}\in \spc{X}_\infty}.\]

We leave part \ref{SHORT.lem:almost-isom-c} as an exercise.
\qedsf

For two metric spaces $\spc{X}$ and $\spc{Y}$,
we write $\spc{X}\le \spc{Y}+\eps$ if
there is a map $f\:\spc{X}\to \spc{Y}$ such that
\[\dist{x}{x'}{\spc{X}}\le \dist{f(x)}{f(x')}{\spc{Y}}+\eps\]
for any $x,x'\in \spc{X}$.

\begin{thm}{Exercise}\label{ex:GH-po}
Let $\spc{X}_1,\spc{X}_2,\dots,$ and $\spc{X}_\infty$ be nonempty compact metric spaces.
Show that there is a Gromov--Hausdorff convergence $\spc{X}_n\z\to\spc{X}_\infty$ if and only if for some sequence $\eps_n\to 0$,
we have
\[\spc{X}_\infty\le \spc{X}_n+\eps_n\quad\text{and}\quad \spc{X}_n\le \spc{X}_\infty+\eps_n.\]
\end{thm}

Lemma~\ref{lem:almost-isom} has a natural analogue for pointed convergence.
For simplicity we only state part \ref{SHORT.lem:almost-isom-a} of the lemma.
Parts \ref{SHORT.lem:almost-isom-b} and \ref{SHORT.lem:almost-isom-c} can be rephrased similarly;
in \ref{SHORT.lem:almost-isom-c} we have to assume that the space is proper.

\begin{thm}{Lemma}\label{lem:almost-isom-pointed}
Let $(\spc{X}_1, p_1),(\spc{X}_2,p_2) ,\dots$, let $(\spc{X}_\infty, p_\infty)$ be pointed metric spaces, and let $\eps(n,R)\to\0+$ as $n\to\infty$ for any fixed $R>0$.
Suppose that for each $n$ there is a map $f_n\:\spc{X}_n\to\spc{X}_\infty$ such that


\begin{subthm}{lem:almost-isom-pointed-basepoint}
$f_n(p_n)\to p_\infty$
\end{subthm}

\begin{subthm}{lem:almost-isom-pointed-b}
$\bigl|\dist{f_n(x)}{f_n(x')}{\spc{X}_\infty }-\dist{x}{x'}{\spc{X}_n}\bigr|\le \eps(n,R)$ for any $x,x'\z\in \oBall(p_n,R)$.
\end{subthm}

\begin{subthm}{lem:almost-isom-pointed-c}
For any $x \in \oBall(p_\infty,R)$ there is $x_n\in \oBall(p_n,R)$ such that $\dist{x}{f_n(x_n)}{}\le \eps(n,R)$
\end{subthm}

Then there is a pointed  Gromov--Hausdorff convergence $(\spc{X}_n,p_n)\z\to (\spc{X}_\infty,p_\infty)$.
\end{thm}

The proofs of \ref{lem:almost-isom-pointed} and \ref{lem:almost-isom} are analogous;
we leave the former to the reader.



\section{Remarks}

In principle, our definition of Gromov--Hausdorff distance can be applied to complete metric spaces that are not necessarily compact.
However, according to the following exercise, it only defines a semimetric; that is, zero Gromov--Hausdorff distance does not imply that the spaces are isometric.
For that reason it is not in use.

\begin{thm}{Exercise}\label{ex:GH-noncompact}
\begin{subthm}{ex:GH-noncompact:proper}
Construct two nonisometric proper (noncompact) metric spaces with vanishing Gromov--Hausdorff distance.
\end{subthm}

\begin{subthm}{ex:GH-noncompact:bounded}

Construct two nonisometric complete geodesic metric spaces of bounded diameter with vanishing Gromov--Hausdorff distance.
\end{subthm}


\end{thm}
